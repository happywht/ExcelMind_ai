# ExcelMind AI 冒烟测试指南

## 测试环境
- **操作系统**: Windows 11
- **Node.js版本**: v22.18.0
- **打包工具**: electron-builder v24.13.3
- **Electron版本**: v28.3.3

## 构建信息
- **构建时间**: 2026-01-24 14:42
- **版本**: 1.0.0
- **架构**: x64
- **安装程序大小**: 109 MB
- **主可执行文件**: 176.8 MB

## 快速冒烟测试步骤

### 1. 安装测试
```bash
# 运行安装程序
"D:\家庭\青聪赋能\excelmind-ai\dist-electron\ExcelMind AI Setup 1.0.0.exe"
```

**验证点**:
- [ ] 安装程序正常启动
- [ ] 可以选择安装目录
- [ ] 安装过程无错误
- [ ] 创建桌面快捷方式
- [ ] 创建开始菜单快捷方式

### 2. 启动测试
```bash
# 直接运行解包版本（更快）
"D:\家庭\青聪赋能\excelmind-ai\dist-electron\win-unpacked\ExcelMind AI.exe"
```

**验证点**:
- [ ] 应用窗口正常打开
- [ ] 窗口尺寸正确（1400x900）
- [ ] 界面加载完整
- [ ] 无控制台错误

### 3. 核心功能测试

#### 3.1 文件上传功能
- [ ] 点击上传按钮
- [ ] 选择Excel文件（.xlsx, .xls）
- [ ] 文件成功加载
- [ ] 显示预览内容

#### 3.2 智能查询功能
- [ ] 输入查询问题
- [ ] AI响应生成
- [ ] 结果正确显示

#### 3.3 多Sheet支持
- [ ] 加载多Sheet Excel文件
- [ ] Sheet切换功能正常
- [ ] 跨Sheet查询工作

#### 3.4 文档生成功能
- [ ] 选择文档模板
- [ ] 映射字段
- [ ] 生成文档
- [ ] 下载文档

#### 3.5 沙箱执行功能
- [ ] Python代码执行
- [ ] 执行结果显示
- [ ] 错误处理

### 4. 应用退出测试
- [ ] 正常关闭窗口
- [ ] 应用完全退出
- [ ] 无残留进程

### 5. 资源清理
- [ ] 检查临时文件清理
- [ ] 检查内存释放
- [ ] 检查沙箱资源清理

## 已知问题和限制

### 构建警告
1. **大块文件警告**
   - 某些chunk超过500KB
   - 影响：无功能影响，可能影响首次加载速度
   - 建议：后续优化代码分割

2. **PDF.js eval警告**
   - PDF.js使用了eval
   - 影响：安全警告，无功能影响
   - 建议：评估替代方案

3. **动态导入警告**
   - 某些模块同时使用静态和动态导入
   - 影响：无功能影响，可能影响代码分割
   - 建议：统一导入方式

4. **缺失资源警告**
   - resources/bin/node.exe 和 resources/bin/node 不存在
   - 影响：无功能影响（使用系统Python）
   - 建议：移除配置或提供资源

### node-pty构建问题
- **问题**: node-pty包的TypeScript编译失败
- **解决方案**: 设置npmRebuild: false跳过重新编译
- **影响**: 可能影响终端功能（如果使用）
- **状态**: 已通过配置解决

## 性能指标

### 构建性能
- **Web资源构建时间**: ~15秒
- **Electron打包时间**: ~20秒
- **总构建时间**: ~35秒

### 应用大小
- **安装程序**: 109 MB
- **解包应用**: ~220 MB
- **app.asar**: 110 MB

## 测试结果记录

### 测试执行人: _______________
### 测试日期: _______________

#### 测试结果汇总
- **测试用例总数**: 20
- **通过**: __
- **失败**: __
- **跳过**: __

#### 发现的问题
1.
2.
3.

#### 建议改进
1.
2.
3.

## 回归风险评估

### 低风险
- Web界面功能
- 文档生成功能
- 基础Excel处理

### 中风险
- 沙箱执行功能（依赖Python环境）
- node-pty相关功能（如果有使用）

### 高风险
- 无

## 下一步行动

### 立即行动
- [ ] 执行完整冒烟测试
- [ ] 记录测试结果
- [ ] 修复发现的严重问题

### 短期优化
- [ ] 优化代码分割减少chunk大小
- [ ] 移除或修复构建警告
- [ ] 添加应用图标

### 长期改进
- [ ] 升级Electron版本
- [ ] 优化应用启动时间
- [ ] 减小应用体积
