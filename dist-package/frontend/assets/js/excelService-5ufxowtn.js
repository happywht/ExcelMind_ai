import"./index-BMR0u2QP.js";import{utils as n,writeFile as g,read as j}from"./xlsx-vendor-CkFp8p6R.js";const D=async e=>new Promise((t,o)=>{const s=new FileReader;s.onload=r=>{var c;try{const f=(c=r.target)==null?void 0:c.result,u=j(f,{type:"array"}),w={},x={};let k="";u.SheetNames.forEach((a,m)=>{m===0&&(k=a);const i=u.Sheets[a],E=n.sheet_to_json(i,{defval:""});w[a]=E;const p={},_={};for(const h in i){if(h.startsWith("!"))continue;const d=i[h];d.c&&d.c.forEach(l=>{if(l.a&&l.t){const S=l.t,b=l.a||"";p[h]=b?`[${b}]: ${S}`:S}}),d.n&&(_[h]=d.n)}const y=n.decode_range(i["!ref"]||"A1"),A=y.e.r+1,F=y.e.c+1;x[a]={comments:p,notes:_,rowCount:A,columnCount:F}}),t({id:e.name+"-"+Date.now(),fileName:e.name,sheets:w,currentSheetName:k,metadata:x})}catch(f){o(f)}},s.onerror=r=>o(r),s.readAsArrayBuffer(e)}),N=(e,t)=>{const o=n.book_new();Object.entries(e).forEach(([s,r])=>{const c=n.json_to_sheet(r);n.book_append_sheet(o,c,s)}),g(o,t.endsWith(".xlsx")?t:`${t}.xlsx`)};export{N as e,D as r};
