const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./SmartExcel-WqqGsPiM.js","./react-vendor-GaDxkzs9.js","./vendor-VUkWwLEC.js","./excelService-D5n1j0dF.js","./xlsx-vendor-CkFp8p6R.js","./icons-vendor-YN3v5u9K.js","./ui-utils-vendor-BNe0Xlio.js","./index-CUt3UCZy.js","./docx-vendor-Bfp-vY9X.js","./index-CBNISGvc.js","./aiProxyService-MHixnMR7.js","./KnowledgeChat-BqeFxh-j.js","./pdf-vendor-7J3DIG-7.js"])))=>i.map(i=>d[i]);
import{j as t,r as h,R as $,b as U}from"./react-vendor-GaDxkzs9.js";import{L as H,F as G,a as z,B as D,S as W,b as V,C as K,A as q,c as I,R as _,H as X,d as J,e as Y,f as Q,g as Z,T as ee,h as te}from"./icons-vendor-YN3v5u9K.js";import{t as re,c as se}from"./ui-utils-vendor-BNe0Xlio.js";import"./vendor-VUkWwLEC.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function r(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(n){if(n.ep)return;n.ep=!0;const a=r(n);fetch(n.href,a)}})();const oe="modulepreload",ae=function(s,e){return new URL(s,e).href},P={},N=function(e,r,o){let n=Promise.resolve();if(r&&r.length>0){const l=document.getElementsByTagName("link"),i=document.querySelector("meta[property=csp-nonce]"),g=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));n=Promise.allSettled(r.map(d=>{if(d=ae(d,o),d in P)return;P[d]=!0;const f=d.endsWith(".css"),w=f?'[rel="stylesheet"]':"";if(!!o)for(let b=l.length-1;b>=0;b--){const x=l[b];if(x.href===d&&(!f||x.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${d}"]${w}`))return;const p=document.createElement("link");if(p.rel=f?"stylesheet":oe,f||(p.as="script"),p.crossOrigin="",p.href=d,g&&p.setAttribute("nonce",g),document.head.appendChild(p),f)return new Promise((b,x)=>{p.addEventListener("load",b),p.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(l){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=l,window.dispatchEvent(i),!i.defaultPrevented)throw l}return n.then(l=>{for(const i of l||[])i.status==="rejected"&&a(i.reason);return e().catch(a)})};var u=(s=>(s.DASHBOARD="DASHBOARD",s.SMART_OPS="SMART_OPS",s.FORMULA="FORMULA",s.KNOWLEDGE_CHAT="KNOWLEDGE_CHAT",s.DOCUMENT_SPACE="DOCUMENT_SPACE",s.BATCH_GENERATION="BATCH_GENERATION",s.DATA_QUALITY="DATA_QUALITY",s.AUDIT_ASSISTANT="AUDIT_ASSISTANT",s.AI_TOOLS="AI_TOOLS",s))(u||{});const ne=({currentView:s,setView:e})=>{const r=[{id:u.DASHBOARD,label:"‰ª™Ë°®Áõò",icon:H},{id:u.SMART_OPS,label:"Êï∞ÊçÆÂ∑•Âùä",icon:G},{id:u.DOCUMENT_SPACE,label:"ÊñáÊ°£ÁîüÊàê",icon:z},{id:u.AUDIT_ASSISTANT,label:"ÂÆ°ËÆ°Âä©Êâã",icon:D},{id:u.AI_TOOLS,label:"ÂÖ¨ÂºèÁîüÊàêÂô®",icon:W}];return t.jsxs("div",{className:"w-64 bg-slate-900 text-white h-screen flex flex-col shadow-xl flex-shrink-0 z-20",children:[t.jsxs("div",{className:"p-6 flex items-center gap-3 border-b border-slate-800",children:[t.jsx("div",{className:"bg-emerald-500 p-2 rounded-lg",children:t.jsx(D,{className:"w-6 h-6 text-white"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"font-bold text-xl tracking-tight",children:"ExcelMind"}),t.jsx("p",{className:"text-xs text-slate-400",children:"AI Êï∞ÊçÆÂä©Êâã"})]})]}),t.jsx("nav",{className:"flex-1 p-4 space-y-2",children:r.map(o=>{const n=o.icon,a=s===o.id;return t.jsxs("button",{onClick:()=>e(o.id),className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all duration-200 group ${a?"bg-emerald-600 text-white shadow-lg shadow-emerald-900/20":"text-slate-400 hover:bg-slate-800 hover:text-white"}`,children:[t.jsx(n,{className:`w-5 h-5 ${a?"text-white":"text-slate-400 group-hover:text-white"}`}),t.jsx("span",{className:"font-medium text-sm",children:o.label})]},o.id)})}),t.jsx("div",{className:"p-4 border-t border-slate-800",children:t.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-3 text-xs text-slate-400",children:[t.jsx("p",{className:"mb-1 font-semibold text-slate-300",children:"‰ΩøÁî®Â∏ÆÂä©:"}),"Â¶ÇÊûú‰ΩøÁî®Á¢∞Âà∞ÈóÆÈ¢òÔºåËØ∑Âí®ËØ¢ËÄÅÁéã„ÄÇ"]})})]})},le={BASE_URL:"./",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_ANTHROPIC_API_KEY:"ccd69d4c776d4e2696a6ef026159fb9c.YUPVkBmrRXu1xoZG",VITE_API_BASE_URL:"/api",VITE_LOG_LEVEL:"debug",VITE_USER_NODE_ENV:"production",VITE_WS_BASE_URL:"ws://localhost:3001"};var T={};const ie={0:"ERROR",1:"WARN",2:"INFO",3:"DEBUG",4:"TRACE"};class O{constructor(e="App",r){const o=typeof import.meta<"u"&&le&&!0,n=typeof process<"u"&&!0;this.isProduction=o||n,this.moduleName=e;const a=this.parseLogLevel(typeof process<"u"&&(T==null?void 0:T.VITE_LOG_LEVEL)||void 0);this.level=a!==void 0?a:this.isProduction?1:3,this.config={minLevel:this.level,enableTimestamp:!this.isProduction,enableModulePrefix:!0,enableColors:!this.isProduction&&typeof window<"u",enableTrace:!this.isProduction,...r}}parseLogLevel(e){if(!e)return;switch(e.toUpperCase()){case"ERROR":return 0;case"WARN":return 1;case"INFO":return 2;case"DEBUG":return 3;case"TRACE":return 4;default:return}}formatPrefix(e){const r=[];if(this.config.enableTimestamp){const o=new Date().toISOString();r.push(o)}return this.config.enableModulePrefix&&r.push(`[${this.moduleName}]`),r.push(`[${ie[e]}]`),r.join(" ")}log(e,r,...o){if(e>this.level)return;const a=`${this.formatPrefix(e)} ${r}`;switch(e){case 0:console.error(a,...o);break;case 1:console.warn(a,...o);break;case 2:console.log(a,...o);break;case 3:console.log(a,...o);break;case 4:this.config.enableTrace&&(console.log(a,...o),(o.length===0||!o[0])&&console.trace("Stack trace"));break}}error(e,...r){this.log(0,e,...r)}warn(e,...r){this.log(1,e,...r)}info(e,...r){this.log(2,e,...r)}debug(e,...r){this.log(3,e,...r)}trace(e,...r){this.log(4,e,...r)}setLevel(e){this.level=e,this.config.minLevel=e}setModule(e){this.moduleName=e}createChild(e){const r=`${this.moduleName}:${e}`;return new O(r,this.config)}}const c=new O;function E(...s){return re(se(s))}function ce(s){return{emerald:{icon:"text-emerald-500",border:"hover:border-emerald-500/30",gradient:"from-emerald-50 to-transparent",gradientHover:"hover:from-emerald-100",shadow:"hover:shadow-emerald"},blue:{icon:"text-blue-500",border:"hover:border-blue-500/30",gradient:"from-blue-50 to-transparent",gradientHover:"hover:from-blue-100",shadow:"hover:shadow-blue"},purple:{icon:"text-purple-500",border:"hover:border-purple-500/30",gradient:"from-purple-50 to-transparent",gradientHover:"hover:from-purple-100",shadow:"hover:shadow-purple"},orange:{icon:"text-orange-500",border:"hover:border-orange-500/30",gradient:"from-orange-50 to-transparent",gradientHover:"hover:from-orange-100",shadow:"hover:shadow-orange"},cyan:{icon:"text-cyan-500",border:"hover:border-cyan-500/30",gradient:"from-cyan-50 to-transparent",gradientHover:"hover:from-cyan-100",shadow:"hover:shadow-cyan"},pink:{icon:"text-pink-500",border:"hover:border-pink-500/30",gradient:"from-pink-50 to-transparent",gradientHover:"hover:from-pink-100",shadow:"hover:shadow-pink"},amber:{icon:"text-amber-500",border:"hover:border-amber-500/30",gradient:"from-amber-50 to-transparent",gradientHover:"hover:from-amber-100",shadow:"hover:shadow-amber"}}[s]}function de(s){return{default:null,new:{text:"NEW",className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white text-xs font-bold px-2 py-1 rounded-md"},hot:{text:"HOT",className:"bg-gradient-to-r from-orange-500 to-red-500 text-white text-xs font-bold px-2 py-1 rounded-md flex items-center gap-1",icon:"üî•"},beta:{text:"BETA",className:"border-2 border-dashed border-slate-300 text-slate-500 text-xs font-bold px-2 py-1 rounded-md"},pro:{text:"PRO",className:"bg-gradient-to-r from-amber-400 to-amber-600 text-white text-xs font-bold px-2 py-1 rounded-md"}}[s]}const he=({status:s})=>{const e=de(s);return e?t.jsxs("div",{className:E("absolute top-4 right-4 z-20",e.className),children:[e.icon&&t.jsx("span",{className:"mr-1",children:e.icon}),e.text]}):null},ue=({count:s})=>{if(!s||s<5)return null;let e="",r="";return s>=50?(e="Â∏∏Áî®",r="bg-blue-100 text-blue-700 text-xs font-medium px-2 py-1 rounded-full"):s>=20?(e=`${s}Ê¨°`,r="bg-slate-100 text-slate-600 text-xs font-medium px-2 py-1 rounded-full"):(e=`${s}Ê¨°`,r="bg-slate-50 text-slate-500 text-xs font-medium px-2 py-1 rounded-full"),t.jsx("span",{className:r,children:e})},me=({shortcut:s})=>s?t.jsxs("div",{className:"flex items-center gap-1 text-slate-400 text-xs",children:[t.jsx("kbd",{className:"px-1.5 py-0.5 bg-slate-100 border border-slate-300 rounded text-slate-500 font-mono",children:s}),t.jsx("span",{children:"ÊâìÂºÄ"})]}):null,y=({title:s,description:e,icon:r,color:o,status:n="default",shortcut:a,usageCount:l,lastUsed:i,onClick:g,disabled:d=!1,className:f})=>{const[w,j]=h.useState(!1),[p,b]=h.useState(!1),x=ce(o),C=V[r],S=()=>{d||(j(!0),setTimeout(()=>j(!1),150),setTimeout(()=>{g()},100))},m=v=>{(v.key==="Enter"||v.key===" ")&&(v.preventDefault(),S())};return t.jsxs("div",{role:"button",tabIndex:0,"aria-label":`${s} - ${e}${a?` (Âø´Êç∑ÈîÆ: ${a})`:""}`,"aria-disabled":d,onClick:S,onKeyDown:m,onFocus:()=>b(!0),onBlur:()=>b(!1),className:E("group relative bg-white p-6 rounded-2xl border border-slate-200","transition-all duration-300 ease-out","cursor-pointer overflow-hidden","hover:shadow-2xl hover:-translate-y-1",x.border,x.gradientHover,p&&"ring-2 ring-offset-2 ring-blue-500",w&&"scale-95",d&&"opacity-50 cursor-not-allowed hover:shadow-sm hover:translate-y-0",f),children:[t.jsx("div",{className:E("absolute top-0 right-0 w-48 h-48 rounded-full","-mr-16 -mt-16 transition-colors duration-300","bg-gradient-to-br",x.gradient,"group-hover:opacity-80")}),t.jsx(he,{status:n}),t.jsxs("div",{className:"relative z-10",children:[t.jsxs("div",{className:"flex items-start justify-between mb-4",children:[t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-0 bg-current opacity-10 rounded-xl blur-xl"}),t.jsx(C,{className:E("w-12 h-12 relative z-10 transition-transform duration-300",x.icon,"group-hover:scale-110 group-hover:rotate-3")})]}),t.jsx(me,{shortcut:a})]}),t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("h3",{className:"text-xl font-bold text-slate-800 group-hover:text-slate-900 transition-colors",children:s}),t.jsx(ue,{count:l})]}),t.jsx("p",{className:"text-slate-500 text-sm leading-relaxed mb-4 group-hover:text-slate-600 transition-colors",children:e}),t.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-slate-100",children:[i&&t.jsxs("span",{className:"text-xs text-slate-400 flex items-center gap-1",children:[t.jsx(K,{className:"w-3 h-3"}),i]}),t.jsxs("div",{className:E("flex items-center gap-1 text-sm font-medium transition-all duration-200",x.icon.replace("text-","text-"),"group-hover:gap-2"),children:["ËøõÂÖ•",t.jsx(q,{className:"w-4 h-4 transition-transform duration-200 group-hover:translate-x-1"})]})]})]}),t.jsx("div",{className:E("absolute bottom-0 left-0 h-0.5 bg-gradient-to-r",x.icon.replace("text-","from-").replace("-500","-400"),"to-transparent transition-all duration-300 group-hover:w-full","w-0")})]})},xe=({children:s,className:e})=>t.jsx("div",{className:E("grid grid-cols-1 gap-6","sm:grid-cols-2","lg:grid-cols-3","xl:grid-cols-4",e),children:s}),ge=({error:s,errorInfo:e,retry:r,resetError:o,showDetails:n=!0})=>{const[a,l]=h.useState(!1),[i,g]=h.useState(!1),d=async()=>{const w=`
ÈîôËØØ‰ø°ÊÅØ: ${s.message}
ÈîôËØØÂ†ÜÊ†à:
${s.stack}

${e?`ÁªÑ‰ª∂Â†ÜÊ†à:
${e.componentStack}`:""}
Êó∂Èó¥: ${new Date().toLocaleString("zh-CN")}
È°µÈù¢URL: ${window.location.href}
Áî®Êà∑‰ª£ÁêÜ: ${navigator.userAgent}
    `.trim();try{await navigator.clipboard.writeText(w),g(!0),setTimeout(()=>g(!1),2e3)}catch(j){c.error("Failed to copy error details:",j)}},f=()=>{window.location.href="/"};return t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex items-center justify-center p-4",children:t.jsxs("div",{className:"max-w-2xl w-full",children:[t.jsxs("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden",children:[t.jsx("div",{className:"h-2 bg-gradient-to-r from-red-500 via-orange-500 to-yellow-500"}),t.jsxs("div",{className:"p-8",children:[t.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[t.jsx("div",{className:"flex-shrink-0 w-16 h-16 bg-red-100 rounded-full flex items-center justify-center",children:t.jsx(I,{className:"w-8 h-8 text-red-500"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"ÂìéÂëÄÔºåÂá∫Èîô‰∫ÜÔºÅ"}),t.jsx("p",{className:"text-slate-500 mt-1",children:"Â∫îÁî®ÈÅáÂà∞‰∫ÜÊÑèÂ§ñÈîôËØØÔºå‰ΩÜÂà´ÊãÖÂøÉÔºåÊàë‰ª¨ÊúâÂäûÊ≥ïËß£ÂÜ≥"})]})]}),t.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 mb-6",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(I,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-amber-900 font-medium mb-1",children:"ÈîôËØØËØ¶ÊÉÖ"}),t.jsx("p",{className:"text-amber-800 text-sm",children:s.message||"Êú™Áü•ÈîôËØØ"})]})]})}),t.jsxs("div",{className:"flex flex-wrap gap-3 mb-6",children:[t.jsxs("button",{onClick:r,className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-medium transition-colors duration-200",children:[t.jsx(_,{className:"w-4 h-4"}),"ÈáçËØïÊìç‰Ωú"]}),t.jsxs("button",{onClick:o,className:"inline-flex items-center gap-2 px-4 py-2 bg-slate-500 hover:bg-slate-600 text-white rounded-lg font-medium transition-colors duration-200",children:[t.jsx(_,{className:"w-4 h-4"}),"Âà∑Êñ∞È°µÈù¢"]}),t.jsxs("button",{onClick:f,className:"inline-flex items-center gap-2 px-4 py-2 bg-white border border-slate-300 hover:bg-slate-50 text-slate-700 rounded-lg font-medium transition-colors duration-200",children:[t.jsx(X,{className:"w-4 h-4"}),"ËøîÂõû‰∏ªÈ°µ"]})]}),n&&e&&t.jsxs("div",{className:"border border-slate-200 rounded-lg overflow-hidden",children:[t.jsxs("button",{onClick:()=>l(!a),className:"w-full px-4 py-3 bg-slate-50 hover:bg-slate-100 flex items-center justify-between transition-colors duration-200",children:[t.jsx("span",{className:"font-medium text-slate-700",children:"ÊäÄÊúØËØ¶ÊÉÖ"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:w=>{w.stopPropagation(),d()},className:"inline-flex items-center gap-1 px-2 py-1 text-xs bg-white border border-slate-300 hover:bg-slate-50 text-slate-600 rounded transition-colors duration-200",title:"Â§çÂà∂ÈîôËØØ‰ø°ÊÅØ",children:i?t.jsxs(t.Fragment,{children:[t.jsx(J,{className:"w-3 h-3"}),"Â∑≤Â§çÂà∂"]}):t.jsxs(t.Fragment,{children:[t.jsx(Y,{className:"w-3 h-3"}),"Â§çÂà∂"]})}),a?t.jsx(Q,{className:"w-4 h-4 text-slate-500"}):t.jsx(Z,{className:"w-4 h-4 text-slate-500"})]})]}),a&&t.jsx("div",{className:"p-4 bg-slate-900 overflow-x-auto",children:t.jsx("pre",{className:"text-xs text-green-400 font-mono whitespace-pre-wrap break-all",children:t.jsx("code",{children:`ÈîôËØØ‰ø°ÊÅØ: ${s.message}

ÈîôËØØÂ†ÜÊ†à:
${s.stack}

${e.componentStack?`ÁªÑ‰ª∂Â†ÜÊ†à:
${e.componentStack}`:""}

Êó∂Èó¥: ${new Date().toLocaleString("zh-CN")}
È°µÈù¢URL: ${window.location.href}
Áî®Êà∑‰ª£ÁêÜ: ${navigator.userAgent}`})})})]})]}),t.jsx("div",{className:"px-8 py-4 bg-slate-50 border-t border-slate-200",children:t.jsxs("p",{className:"text-sm text-slate-600 text-center",children:["Â¶ÇÊûúÈóÆÈ¢òÊåÅÁª≠Â≠òÂú®ÔºåËØ∑Â∞ùËØï"," ",t.jsx("button",{onClick:d,className:"text-blue-600 hover:text-blue-700 underline",children:"Â§çÂà∂ÈîôËØØ‰ø°ÊÅØ"})," ","Âπ∂ËÅîÁ≥ªÊäÄÊúØÊîØÊåÅ"]})})]}),t.jsx("div",{className:"mt-4 text-center",children:t.jsx("p",{className:"text-sm text-slate-500",children:"ÈîôËØØÂ∑≤Ëá™Âä®ËÆ∞ÂΩïÔºåÊàë‰ª¨‰ºöÊåÅÁª≠ÊîπËøõ‰∫ßÂìÅ‰ΩìÈ™å"})})]})})},fe={enableConsole:!0,enableLocalStorage:!0,enableRemote:!1,maxLocalStorageEntries:50};class pe{constructor(e={}){this.storageKey="errordetails",this.config={...fe,...e}}updateConfig(e){this.config={...this.config,...e}}async logError(e,r={}){const o={error:e,message:e.message,stack:e.stack,componentStack:r.componentStack,errorBoundary:r.errorBoundary,timestamp:r.timestamp||new Date().toISOString(),url:window.location.href,userInfo:r.userInfo,context:r};if(this.config.enableConsole&&this.logToConsole(o),this.config.enableLocalStorage&&this.logToLocalStorage(o),this.config.customReporter)try{await this.config.customReporter(o)}catch(n){c.error("Custom error reporter failed:",n)}this.config.enableRemote&&this.config.remoteEndpoint&&await this.logToRemote(o)}logToConsole(e){const r="color: #dc2626; font-weight: bold;",o="color: #64748b;";console.group("%c‚ùå Error Logged",r),c.debug("%cMessage:",o,e.message),c.debug("%cTime:",o,e.timestamp),c.debug("%cURL:",o,e.url),e.componentStack&&c.debug("%cComponent Stack:",o,e.componentStack),e.stack&&c.debug("%cStack Trace:",o,e.stack),e.context&&c.debug("%cContext:",o,e.context),console.groupEnd()}logToLocalStorage(e){try{const o=[...this.getStoredLogs(),e],n=this.config.maxLocalStorageEntries||50,a=o.slice(-n);localStorage.setItem(this.storageKey,JSON.stringify(a))}catch(r){c.error("Failed to save error log to localStorage:",r)}}async logToRemote(e){if(this.config.remoteEndpoint)try{const r=await fetch(this.config.remoteEndpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!r.ok)throw new Error(`Remote logging failed: ${r.statusText}`)}catch(r){c.error("Failed to send error log to remote server:",r)}}getStoredLogs(){try{const e=localStorage.getItem(this.storageKey);return e?JSON.parse(e):[]}catch(e){return c.error("Failed to retrieve error logs from localStorage:",e),[]}}clearStoredLogs(){try{localStorage.removeItem(this.storageKey)}catch(e){c.error("Failed to clear error logs from localStorage:",e)}}exportLogs(){const e=this.getStoredLogs();return JSON.stringify(e,null,2)}getErrorStats(){const e=this.getStoredLogs(),r=e.filter(a=>a.errorBoundary).length,o=new Map;e.forEach(a=>{const l=a.message||"Unknown Error";o.set(l,(o.get(l)||0)+1)});const n=Array.from(o.entries()).map(([a,l])=>({message:a,count:l})).sort((a,l)=>l.count-a.count).slice(0,10);return{totalErrors:e.length,errorBoundaryErrors:r,mostCommonErrors:n}}}const be=new pe;function R(s,e){be.logError(s,e).catch(r=>{c.error("Failed to log error:",r)})}class we extends h.Component{constructor(e){super(e),this.handleRetry=()=>{this.setState({hasError:!1,error:null,errorInfo:null})},this.handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null}),window.location.reload()},this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,r){var o,n;this.setState({errorInfo:r});try{this.props.errorLogger?this.props.errorLogger(e,r):R(e,{componentStack:r.componentStack,errorBoundary:!0,timestamp:new Date().toISOString()})}catch(a){c.error("Failed to log error:",a),c.error("Original error:",e,r)}(n=(o=this.props).onError)==null||n.call(o,e,r)}render(){const{hasError:e,error:r,errorInfo:o}=this.state,{children:n,fallback:a,showDetails:l=!0}=this.props;if(e&&r){const i=a||ge;return t.jsx(i,{error:r,errorInfo:o||void 0,retry:this.handleRetry,resetError:this.handleReset,showDetails:l})}return n}}class ve extends h.Component{constructor(e){super(e),this.handleRetry=()=>{this.setState({hasError:!1,error:null}),window.location.reload()},this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,r){console.error("Lazy load error:",e,r)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:t.jsx("div",{className:"flex items-center justify-center h-screen bg-slate-50 p-6",children:t.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-8 text-center space-y-6",children:[t.jsx("div",{className:"flex justify-center",children:t.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center",children:t.jsx(ee,{className:"w-8 h-8 text-red-500"})})}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Âä†ËΩΩÂ§±Ë¥•"}),t.jsx("p",{className:"text-slate-600",children:"ÁªÑ‰ª∂Âä†ËΩΩÂ§±Ë¥•ÔºåÂèØËÉΩÊòØÁΩëÁªúÈóÆÈ¢òÊàñËµÑÊ∫êÊöÇÊó∂‰∏çÂèØÁî®„ÄÇ"})]}),!1,t.jsxs("button",{onClick:this.handleRetry,className:"w-full bg-emerald-500 hover:bg-emerald-600 text-white font-medium py-3 px-6 rounded-lg transition-colors flex items-center justify-center space-x-2",children:[t.jsx(_,{className:"w-5 h-5"}),t.jsx("span",{children:"ÈáçÊñ∞Âä†ËΩΩ"})]}),t.jsx("p",{className:"text-xs text-slate-400",children:"Â¶ÇÊûúÈóÆÈ¢òÊåÅÁª≠Â≠òÂú®ÔºåËØ∑Ê£ÄÊü•ÁΩëÁªúËøûÊé•ÊàñËÅîÁ≥ªÊäÄÊúØÊîØÊåÅ„ÄÇ"})]})}):this.props.children}}const je=({message:s="Âä†ËΩΩ‰∏≠...",size:e="lg"})=>{const r={sm:"w-6 h-6",md:"w-10 h-10",lg:"w-16 h-16"},o={sm:"text-sm",md:"text-base",lg:"text-lg"};return t.jsx("div",{className:"flex items-center justify-center h-screen bg-slate-50",children:t.jsxs("div",{className:"text-center space-y-4",children:[t.jsx(te,{className:`${r[e]} text-emerald-500 animate-spin mx-auto`}),t.jsx("p",{className:`${o[e]} text-slate-600 font-medium`,children:s}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("div",{className:"w-48 h-2 bg-slate-200 rounded-full overflow-hidden mx-auto",children:t.jsx("div",{className:"h-full bg-gradient-to-r from-emerald-400 to-emerald-600 rounded-full animate-pulse"})}),t.jsx("p",{className:"text-xs text-slate-400",children:"Ê≠£Âú®Âä†ËΩΩËµÑÊ∫êÔºåËØ∑Á®çÂÄô..."})]})]})})},Ee={showAlert:!1,devMode:!1};class Ne{constructor(e={}){this.config={...Ee,...e},this.handleErrorBound=this.handleError.bind(this),this.handleUnhandledRejectionBound=this.handleUnhandledRejection.bind(this)}updateConfig(e){this.config={...this.config,...e}}start(){window.addEventListener("error",this.handleErrorBound),window.addEventListener("unhandledrejection",this.handleUnhandledRejectionBound),c.error("‚úÖ Global error handlers started")}stop(){window.removeEventListener("error",this.handleErrorBound),window.removeEventListener("unhandledrejection",this.handleUnhandledRejectionBound),c.error("‚èπÔ∏è  Global error handlers stopped")}handleError(e){var o;e.preventDefault();const r=new Error(e.message);r.stack=((o=e.error)==null?void 0:o.stack)||"",R(r,{filename:e.filename,lineno:e.lineno,colno:e.colno,source:"global-error",timestamp:new Date().toISOString()}),this.config.devMode&&(console.group("%c‚ùå Global Error","color: #dc2626; font-weight: bold;"),c.error("Message:",e.message),c.error("Source:",e.filename,e.lineno,e.colno),c.error("Error:",e.error),console.groupEnd()),this.config.customHandler&&this.config.customHandler(e),this.config.showAlert&&this.showErrorAlert(e.message)}handleUnhandledRejection(e){e.preventDefault();let r;e.reason instanceof Error?r=e.reason:r=new Error(String(e.reason)),R(r,{source:"unhandled-rejection",promise:"Promise rejection",timestamp:new Date().toISOString()}),this.config.devMode&&(console.group("%c‚ùå Unhandled Promise Rejection","color: #dc2626; font-weight: bold;"),c.error("Reason:",e.reason),c.error("Promise:",e.promise),console.groupEnd()),this.config.showAlert&&this.showErrorAlert("Êìç‰ΩúÂ§±Ë¥•ÔºåËØ∑Á®çÂêéÈáçËØï")}showErrorAlert(e){const r=document.createElement("div");r.className=`
      fixed top-4 right-4 max-w-md bg-red-500 text-white px-6 py-4 rounded-lg shadow-lg
      z-[9999] animate-slide-in flex items-start gap-3
    `,r.innerHTML=`
      <svg class="w-6 h-6 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      <div class="flex-1">
        <p class="font-medium">Êìç‰ΩúÂ§±Ë¥•</p>
        <p class="text-sm text-red-100 mt-1">${e}</p>
      </div>
      <button class="text-red-100 hover:text-white" onclick="this.parentElement.remove()">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
    `,document.body.appendChild(r),setTimeout(()=>{r.remove()},3e3)}}const M=new Ne;function Se(s){s&&M.updateConfig(s),M.start()}const ye=async()=>await N(()=>import("./xlsx-vendor-CkFp8p6R.js"),[],import.meta.url),k=new Map,Ce=async(s,e)=>{if(k.has(s))return k.get(s);const r=await e();return k.set(s,r),r},Le=async()=>{"requestIdleCallback"in window&&window.requestIdleCallback(async()=>{try{await Ce("xlsx",ye),console.log("[È¢ÑÂä†ËΩΩ] XLSXÊ®°ÂùóÂ∑≤ÁºìÂ≠ò")}catch(s){console.warn("[È¢ÑÂä†ËΩΩ] XLSXÊ®°ÂùóÂä†ËΩΩÂ§±Ë¥•:",s)}})},F=h.createContext(void 0),Ae=({children:s})=>{const[e,r]=h.useState(null),[o,n]=h.useState(null),[a,l]=h.useState(u.DASHBOARD),[i,g]=h.useState([]),[d,f]=h.useState(null),w=m=>{l(m)},j=m=>{r(m)},p=m=>{n(m)},b=()=>{r(null),n(null)},x=m=>{g(v=>[...v,...m])},C=m=>{g(v=>v.filter(L=>L.id!==m)),d===m&&f(null)},S=(m,v)=>{g(L=>L.map(A=>A.id===m?{...A,...v}:A))};return t.jsx(F.Provider,{value:{currentExcelData:e,currentTemplate:o,currentView:a,filesData:i,activeFileId:d,setExcelData:j,setTemplate:p,setView:w,clearWorkspace:b,setFilesData:g,setActiveFileId:f,addFiles:x,removeFile:C,updateFile:S},children:s})},Te=()=>{const s=h.useContext(F);if(s===void 0)throw new Error("useWorkspace must be used within a WorkspaceProvider");return s},ke=h.lazy(()=>N(()=>import("./SmartExcel-WqqGsPiM.js"),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url)),_e=h.lazy(()=>N(()=>import("./index-CUt3UCZy.js"),__vite__mapDeps([7,1,2,3,4,8,5,6]),import.meta.url)),Re=h.lazy(()=>N(()=>import("./index-CBNISGvc.js"),__vite__mapDeps([9,1,2,10,5,6]),import.meta.url)),Oe=h.lazy(()=>N(()=>import("./KnowledgeChat-BqeFxh-j.js"),__vite__mapDeps([11,1,2,10,4,8,12,5,6]),import.meta.url)),De=({setView:s})=>t.jsxs("div",{className:"p-8 max-w-7xl mx-auto",children:[t.jsxs("div",{className:"mb-10",children:[t.jsx("h1",{className:"text-4xl font-extrabold text-slate-800 tracking-tight mb-2",children:"Ê¨¢Ëøé‰ΩøÁî® ExcelMind AI"}),t.jsx("p",{className:"text-xl text-slate-500",children:"ÊÇ®ÁöÑÊô∫ËÉΩÊï∞ÊçÆÂ§ÑÁêÜ„ÄÅË¥¢Âä°‰∏éÂÆ°ËÆ°Âä©Êâã„ÄÇ"})]}),t.jsxs(xe,{children:[t.jsx(y,{title:"Êï∞ÊçÆÂ∑•Âùä",description:"ÂØºÂÖ• Excel Êï∞ÊçÆÔºå‰ΩøÁî®Ëá™ÁÑ∂ËØ≠Ë®ÄÊàñË¥®ÈáèËßÑÂàôËøõË°åÊ∏ÖÊ¥ó„ÄÅËΩ¨Êç¢ÂíåÈ¢ÑÂ§ÑÁêÜ„ÄÇ",icon:"FileSpreadsheet",color:"emerald",status:"hot",shortcut:"1",onClick:()=>s(u.SMART_OPS)}),t.jsx(y,{title:"ÊñáÊ°£ÁîüÊàê",description:"Âü∫‰∫é Excel Êï∞ÊçÆÂíå Word Ê®°ÊùøÔºåÊâπÈáèÁîüÊàêÂêàÂêå„ÄÅÊä•ÂëäÊàñÈÄöÁü•Âçï„ÄÇ",icon:"FileEdit",color:"orange",status:"new",shortcut:"2",onClick:()=>s(u.DOCUMENT_SPACE)}),t.jsx(y,{title:"ÂÆ°ËÆ°Âä©Êâã",description:"‰∏ä‰º†ÂÆ°ËÆ°ÂáÜÂàôÊàñË¥¢Âä°ÊîøÁ≠ñÊñá‰ª∂Ôºå‰∏éÊÇ®ÁöÑ‰∏ìÂ±ûÁü•ËØÜÂ∫ìËøõË°åÂØπËØùÈóÆÁ≠î„ÄÇ",icon:"Bot",color:"pink",status:"hot",shortcut:"3",onClick:()=>s(u.AUDIT_ASSISTANT)}),t.jsx(y,{title:"ÂÖ¨ÂºèÁîüÊàêÂô®",description:"Êó†ÈúÄÊâãÂä®ÊêúÁ¥¢„ÄÇÂè™ÈúÄÊèèËø∞ÊÇ®ÁöÑÈÄªËæëÔºåÂç≥ÂèØ‰∏ÄÈîÆÂ§çÂà∂ÁîüÊàêÁöÑ Excel ÂÖ¨Âºè„ÄÇ",icon:"FunctionSquare",color:"purple",shortcut:"4",onClick:()=>s(u.AI_TOOLS)})]})]}),Ie=()=>{const{currentView:s,setView:e,setTemplate:r,setExcelData:o}=Te();h.useEffect(()=>{Se({showAlert:!1,devMode:!1}),Le()},[]);const n=()=>{switch(s){case u.SMART_OPS:return t.jsx(ke,{});case u.AI_TOOLS:return t.jsx(Re,{});case u.AUDIT_ASSISTANT:return t.jsx("div",{className:"h-full p-4",children:t.jsx("div",{className:"h-full bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden",children:t.jsx(Oe,{})})});case u.DOCUMENT_SPACE:return t.jsx(_e,{});default:return t.jsx(De,{setView:e})}};return t.jsxs("div",{className:"flex h-screen w-full bg-slate-50 overflow-hidden font-sans",children:[t.jsx(ne,{currentView:s,setView:e}),t.jsx("main",{className:"flex-1 h-full overflow-hidden relative",children:t.jsx(ve,{children:t.jsx(h.Suspense,{fallback:t.jsx(je,{message:"Âä†ËΩΩÂäüËÉΩÊ®°Âùó‰∏≠..."}),children:n()})})})]})},Pe=()=>t.jsx(we,{showDetails:!1,children:t.jsx(Ae,{children:t.jsx(Ie,{})})}),B=document.getElementById("root");if(!B)throw new Error("Could not find root element to mount to");const Me=$.createRoot(B);Me.render(t.jsx(U.StrictMode,{children:t.jsx(Pe,{})}));export{u as A,N as _,c as l,Te as u};
