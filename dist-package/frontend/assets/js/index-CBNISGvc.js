import{r as a,j as e}from"./react-vendor-GaDxkzs9.js";import{g as j}from"./aiProxyService-MHixnMR7.js";import{l as g}from"./index-qAfVvIMr.js";import{ag as N,d as v,e as w,A as y,S as k}from"./icons-vendor-YN3v5u9K.js";import"./vendor-VUkWwLEC.js";import"./ui-utils-vendor-BNe0Xlio.js";const E=()=>{const[l,n]=a.useState(""),[r,d]=a.useState(""),[o,c]=a.useState(!1),[x,i]=a.useState(!1),[m,t]=a.useState(null),u=[{name:"æ¡ä»¶åˆ¤æ–­",formula:'å¦‚æœA1å¤§äº100æ˜¾ç¤º"é«˜"ï¼Œå¦åˆ™æ˜¾ç¤º"ä½"'},{name:"æŸ¥æ‰¾åŒ¹é…",formula:"åœ¨Båˆ—æŸ¥æ‰¾A1çš„å€¼ï¼Œè¿”å›Cåˆ—å¯¹åº”çš„æ•°æ®"},{name:"æ¡ä»¶æ±‚å’Œ",formula:"å¯¹Aåˆ—ä¸­å¤§äº0çš„æ•°å€¼æ±‚å’Œ"},{name:"å­—ç¬¦ä¸²æ‹¼æ¥",formula:"å°†Aåˆ—å’ŒBåˆ—çš„æ–‡æœ¬è¿æ¥åœ¨ä¸€èµ·"},{name:"æ—¥æœŸè®¡ç®—",formula:"è®¡ç®—ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„å¤©æ•°å·®"},{name:"æ•°æ®éªŒè¯",formula:"æ£€æŸ¥A1æ˜¯å¦ä¸ºç©ºï¼Œä¸ºç©ºæ˜¾ç¤º0ï¼Œå¦åˆ™æ˜¾ç¤ºå€¼"}],h=async()=>{if(l.trim()){c(!0),t(null),d("");try{const s=await j(l);s==="ç”Ÿæˆå…¬å¼å¤±è´¥"||s==="=ERROR()"?t("å…¬å¼ç”Ÿæˆå¤±è´¥ï¼Œè¯·å°è¯•æ›´è¯¦ç»†çš„æè¿°"):d(s)}catch(s){g.error("Formula generation error:",s),t(`ç”Ÿæˆé”™è¯¯: ${s.message}`)}c(!1)}},p=s=>{n(s.formula),t(null)},b=()=>{navigator.clipboard.writeText(r),i(!0),setTimeout(()=>i(!1),2e3)};return e.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-slate-800 mb-2",children:"Excel å…¬å¼ç”Ÿæˆå™¨"}),e.jsx("p",{className:"text-slate-500",children:"ç”¨è‡ªç„¶è¯­è¨€æè¿°æ‚¨çš„è®¡ç®—éœ€æ±‚ï¼Œç«‹å³è·å– Excel å…¬å¼ã€‚"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-700 mb-3",children:"å¿«é€Ÿç¤ºä¾‹"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:u.map((s,f)=>e.jsx("button",{onClick:()=>p(s),className:"px-3 py-1.5 text-sm bg-white border border-slate-200 rounded-lg hover:border-emerald-300 hover:bg-emerald-50 transition-colors text-slate-600",children:s.name},f))})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8 items-stretch",children:[e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-slate-200 flex flex-col",children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"æè¿°æ‚¨çš„éœ€æ±‚"}),e.jsx("textarea",{className:"flex-1 w-full p-4 rounded-xl border border-slate-200 bg-slate-50 focus:ring-2 focus:ring-emerald-500 focus:border-transparent outline-none resize-none transition-all text-slate-700",placeholder:"ä¾‹å¦‚ï¼šå¦‚æœ A åˆ—å¤§äº 100ï¼Œåˆ™æ˜¾ç¤º'é«˜'ï¼Œå¦åˆ™æ˜¾ç¤º'ä½'ã€‚",value:l,onChange:s=>n(s.target.value)}),e.jsx("button",{onClick:h,disabled:o||!l,className:`mt-4 w-full py-3 px-4 rounded-xl flex items-center justify-center gap-2 font-medium transition-all ${o||!l?"bg-slate-100 text-slate-400 cursor-not-allowed":"bg-emerald-600 text-white hover:bg-emerald-700 shadow-md hover:shadow-lg"}`,children:o?e.jsx("span",{className:"animate-pulse",children:"æ­£åœ¨ç”Ÿæˆ..."}):e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"w-4 h-4"}),"ç”Ÿæˆå…¬å¼"]})})]}),e.jsxs("div",{className:"bg-slate-900 p-6 rounded-2xl shadow-lg flex flex-col justify-center relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-32 bg-emerald-500/10 rounded-full blur-3xl -mr-16 -mt-16 pointer-events-none"}),e.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-4 uppercase tracking-wider",children:"ç”Ÿæˆç»“æœ"}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:m?e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"bg-red-900/20 border border-red-800 rounded-xl p-6 text-red-300",children:e.jsx("p",{className:"text-sm",children:m})})}):r?e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-6 border border-slate-700 backdrop-blur-sm relative group",children:[e.jsx("code",{className:"text-emerald-400 text-xl font-mono break-all block",children:r}),e.jsx("button",{onClick:b,className:"absolute top-2 right-2 p-2 rounded-lg bg-slate-700 text-slate-300 hover:bg-slate-600 transition-colors opacity-0 group-hover:opacity-100",title:"å¤åˆ¶åˆ°å‰ªè´´æ¿",children:x?e.jsx(v,{className:"w-4 h-4 text-emerald-400"}):e.jsx(w,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx("p",{className:"text-xs text-slate-500",children:"ğŸ’¡ æç¤ºï¼šå¤åˆ¶å…¬å¼åï¼Œåœ¨Excelä¸­é€‰æ‹©ç›®æ ‡å•å…ƒæ ¼å¹¶ç²˜è´´"})})]}):e.jsxs("div",{className:"text-center text-slate-600",children:[e.jsx(y,{className:"w-8 h-8 mx-auto mb-2 opacity-20"}),e.jsx("p",{children:"å‡†å¤‡å°±ç»ª"})]})})]})]})]})},T=()=>e.jsxs("div",{className:"h-full flex flex-col bg-slate-50",children:[e.jsx("div",{className:"bg-white border-b border-slate-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(k,{className:"w-6 h-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Excel å…¬å¼ç”Ÿæˆå™¨"}),e.jsx("p",{className:"text-sm text-slate-500",children:"æè¿°æ‚¨çš„é€»è¾‘ï¼ŒAI è‡ªåŠ¨ä¸ºæ‚¨ç”Ÿæˆå¤æ‚çš„ Excel å…¬å¼"})]})]})}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx("div",{className:"h-full overflow-y-auto",children:e.jsx(E,{})})})]});export{T as default};
