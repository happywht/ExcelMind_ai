# ExcelMind AI Phase 2 - æ¶æ„è¯„å®¡æŠ¥å‘Š

**è¯„å®¡æ—¥æœŸ**: 2025-01-15
**è¯„å®¡äºº**: é¦–å¸­æ¶æ„å¸ˆ
**æ–‡æ¡£ç‰ˆæœ¬**: 1.0
**è¯„å®¡èŒƒå›´**: ç¬¬äºŒé˜¶æ®µç»¼åˆè¯„ä¼°æ–¹æ¡ˆï¼ˆå‰ç«¯ã€åç«¯ã€å…¨æ ˆé›†æˆï¼‰

---

## æ‰§è¡Œæ‘˜è¦

### è¯„å®¡ç»“è®º: âš ï¸ **æœ‰æ¡ä»¶é€šè¿‡ (Conditional Go)**

**æ€»ä½“è¯„åˆ†**: 7.5/10

ç»è¿‡å…¨é¢æ¶æ„è¯„å®¡ï¼ŒPhase 2 æ–¹æ¡ˆåœ¨**æŠ€æœ¯å¯è¡Œæ€§**å’Œ**æ¶æ„è®¾è®¡**æ–¹é¢è¡¨ç°è‰¯å¥½ï¼Œä½†å­˜åœ¨ä»¥ä¸‹**å…³é”®é£é™©**éœ€è¦åœ¨å®æ–½å‰è§£å†³ï¼š

âœ… **ä¼˜åŠ¿**:
- æ¶æ„åˆ†å±‚æ¸…æ™°ï¼Œæ¨¡å—èŒè´£æ˜ç¡®
- æŠ€æœ¯æ ˆé€‰æ‹©åˆç†ï¼Œç¬¦åˆç°ä»£æœ€ä½³å®è·µ
- å…·å¤‡è‰¯å¥½çš„å¯æ‰©å±•æ€§å’Œå¯ç»´æŠ¤æ€§åŸºç¡€
- å®Œå–„çš„é”™è¯¯å¤„ç†å’Œè‡ªæ„ˆæœºåˆ¶

âš ï¸ **éœ€è§£å†³çš„é£é™©**:
1. **æ¶æ„ä¸€è‡´æ€§**: å‰åç«¯æ•°æ®æ¨¡å‹å­˜åœ¨ç»†å¾®ä¸åŒ¹é…
2. **æ€§èƒ½ç“¶é¢ˆ**: WebSocket å’Œå¤§æ•°æ®å¤„ç†ç¼ºä¹ä¼˜åŒ–ç­–ç•¥
3. **å•ç‚¹æ•…éšœ**: AI æœåŠ¡ä¾èµ–å­˜åœ¨å•ç‚¹é£é™©
4. **æŠ€æœ¯é”å®š**: Pyodide ä¾èµ–å¯èƒ½å¸¦æ¥è¿ç§»æˆæœ¬

### å»ºè®®è¡ŒåŠ¨

**åœ¨å¯åŠ¨ Phase 1 å‰**ï¼Œå¿…é¡»å®Œæˆä»¥ä¸‹æ”¹è¿›ï¼š

1. **é«˜ä¼˜å…ˆçº§** (é˜»å¡å‘å¸ƒ):
   - ç»Ÿä¸€å‰åç«¯æ•°æ®æ¨¡å‹å®šä¹‰
   - å®æ–½ AI æœåŠ¡é™çº§ç­–ç•¥
   - è®¾è®¡æ€§èƒ½ç›‘æ§å’Œä¼˜åŒ–æœºåˆ¶

2. **ä¸­ä¼˜å…ˆçº§** (çº³å…¥ Phase 1):
   - å®Œå–„ WebSocket è¿æ¥ç®¡ç†
   - å®æ–½æ•°æ®åˆ†é¡µå’Œè™šæ‹ŸåŒ–
   - å»ºç«‹æ¶æ„å†³ç­–è®°å½• (ADR) æµç¨‹

3. **ä½ä¼˜å…ˆçº§** (åç»­è¿­ä»£):
   - è¯„ä¼° Pyodide æ›¿ä»£æ–¹æ¡ˆ
   - ä¼˜åŒ–ç¼“å­˜ç­–ç•¥
   - å®æ–½æ¸è¿›å¼å¢å¼º

---

## 1. æ¶æ„ä¸€è‡´æ€§è¯„å®¡

### 1.1 æ•´ä½“æ¶æ„åˆ†æ

#### æ¶æ„åˆ†å±‚ âœ…

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Presentation Layer                        â”‚
â”‚  (React Components + TypeScript + Tailwind CSS)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚ REST API / WebSocket
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Application Layer                          â”‚
â”‚  (IntelligentDocumentService + AgenticOrchestrator)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Domain Layer                             â”‚
â”‚  (MappingSchemaV2 + ProcessingStage + AIRound)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Infrastructure Layer                        â”‚
â”‚  (AI Service + Cache + Storage + Python Runtime)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è¯„ä¼°**: âœ… **ä¼˜ç§€**
- åˆ†å±‚æ¸…æ™°ï¼ŒèŒè´£æ˜ç¡®
- ç¬¦åˆ DDD (Domain-Driven Design) åŸåˆ™
- ä¾èµ–æ–¹å‘æ­£ç¡®ï¼ˆè‡ªä¸Šè€Œä¸‹ï¼‰

#### æ¨¡å—è¾¹ç•Œ âš ï¸

**å‰ç«¯æ¨¡å—**:
```
components/
â”œâ”€â”€ MappingEditor/          # æ˜ å°„ç¼–è¾‘å™¨
â”œâ”€â”€ DocumentSpace/          # æ–‡æ¡£ç©ºé—´
â”œâ”€â”€ QueryVisualizer/        # æŸ¥è¯¢å¯è§†åŒ–
â”œâ”€â”€ SQLPreview/             # SQL é¢„è§ˆ
â””â”€â”€ Monitoring/             # ç›‘æ§é¢æ¿
```

**åç«¯æœåŠ¡**:
```
services/
â”œâ”€â”€ intelligentDocumentService.ts    # æ™ºèƒ½æ–‡æ¡£æœåŠ¡
â”œâ”€â”€ docxtemplaterService.ts          # æ–‡æ¡£ç”Ÿæˆ
â”œâ”€â”€ agentic/                         # ç¼–æ’å±‚
â”‚   â””â”€â”€ AgenticOrchestrator.ts
â”œâ”€â”€ ai/                              # AI æœåŠ¡å±‚
â””â”€â”€ queryEngine/                     # æŸ¥è¯¢å¼•æ“
```

**é—®é¢˜**: âš ï¸ **æ¨¡å—è¾¹ç•Œæ¨¡ç³Š**

1. **MappingEditor** å’Œ **DocumentSpace** åŠŸèƒ½é‡å 
   - MappingEditor è´Ÿè´£æ˜ å°„ç¼–è¾‘
   - DocumentSpace ä¹Ÿæœ‰æ˜ å°„é…ç½®åŠŸèƒ½
   - **å»ºè®®**: æ˜ç¡®èŒè´£è¾¹ç•Œï¼Œæˆ–åˆå¹¶ä¸ºç»Ÿä¸€æ¨¡å—

2. **åç«¯æœåŠ¡èŒè´£åˆ†æ•£**
   - `intelligentDocumentService` å’Œ `AgenticOrchestrator` éƒ½è´Ÿè´£ä»»åŠ¡ç¼–æ’
   - **å»ºè®®**: ç»Ÿä¸€ç¼–æ’é€»è¾‘åˆ° AgenticOrchestrator

### 1.2 æ•°æ®æ¨¡å‹ä¸€è‡´æ€§

#### ç±»å‹å®šä¹‰å¯¹æ¯” âš ï¸

| æ¨¡å‹ | å‰ç«¯ä½ç½® | åç«¯ä½ç½® | ä¸€è‡´æ€§ |
|------|---------|---------|--------|
| `ProcessingStage` | âŒ æœªå®šä¹‰ | âœ… mappingSchemaV2.ts | âŒ ä¸ä¸€è‡´ |
| `AIRound` | âŒ æœªå®šä¹‰ | âœ… mappingSchemaV2.ts | âŒ ä¸ä¸€è‡´ |
| `TaskStatus` | âŒ æœªå®šä¹‰ | âœ… agenticTypes.ts | âŒ ä¸ä¸€è‡´ |
| `FieldMappingV2` | âŒ æœªå®šä¹‰ | âœ… mappingSchemaV2.ts | âŒ ä¸ä¸€è‡´ |

**é—®é¢˜**: âŒ **ä¸¥é‡**
- å‰ç«¯ç¼ºå°‘ç»Ÿä¸€ç±»å‹å®šä¹‰
- ä¾èµ–åç«¯ç±»å‹å¯¼å…¥ï¼ˆè·¨æ¨¡å—è€¦åˆï¼‰
- TypeScript ç±»å‹å®‰å…¨æ€§æ— æ³•ä¿éšœ

**å»ºè®®**: ğŸ”§ **å¿…é¡»ä¿®å¤**

```typescript
// å»ºè®®åˆ›å»ºå…±äº«ç±»å‹åº“
// packages/shared-types/src/

export * from './types/processing';
export * from './types/ai';
export * from './types/mapping';

// å‰ç«¯å¼•ç”¨
import { ProcessingStage, AIRound } from '@shared-types';

// åç«¯å¼•ç”¨
import { ProcessingStage, AIRound } from '@shared-types';
```

#### API å¥‘çº¦ä¸€è‡´æ€§ âœ…

**API Specification** (API_SPECIFICATION.md):
- âœ… RESTful è·¯ç”±å®šä¹‰æ¸…æ™°
- âœ… è¯·æ±‚/å“åº”æ ¼å¼ç»Ÿä¸€
- âœ… é”™è¯¯å¤„ç†æ ‡å‡†åŒ–
- âœ… WebSocket äº‹ä»¶æµå®šä¹‰

**è¯„ä¼°**: âœ… **è‰¯å¥½**
- API è®¾è®¡ç¬¦åˆ REST æœ€ä½³å®è·µ
- æ”¯æŒåˆ†é¡µã€è¿‡æ»¤ã€æ’åº
- é”™è¯¯ä»£ç ä½“ç³»å®Œå–„

### 1.3 æ¥å£åŒ¹é…åº¦

#### å‰åç«¯æ¥å£æ˜ å°„ âœ…

| åŠŸèƒ½ | å‰ç«¯ç»„ä»¶ | åç«¯ API | åŒ¹é…åº¦ |
|------|---------|---------|--------|
| åˆ›å»ºä»»åŠ¡ | DocumentSpace | POST /api/v1/tasks | âœ… 100% |
| è·å–çŠ¶æ€ | Monitoring | GET /api/v1/tasks/{id}/status | âœ… 100% |
| æäº¤åé¦ˆ | MappingEditor | POST /api/v1/tasks/{id}/feedback | âœ… 100% |
| ä¸‹è½½æ–‡æ¡£ | DocumentSpace | GET /api/v1/tasks/{id}/documents/{docId} | âœ… 100% |
| WebSocket å®æ—¶æ›´æ–° | Monitoring | WS /api/v1/stream | âœ… 100% |

**è¯„ä¼°**: âœ… **ä¼˜ç§€**
- æ‰€æœ‰åŠŸèƒ½éƒ½æœ‰å¯¹åº”çš„ API æ”¯æŒ
- æ•°æ®æµè®¾è®¡åˆç†
- æ”¯æŒè½®è¯¢å’Œ WebSocket ä¸¤ç§æ¨¡å¼

---

## 2. å¯æ‰©å±•æ€§è¯„å®¡

### 2.1 æ°´å¹³æ‰©å±•èƒ½åŠ›

#### æ— çŠ¶æ€æ¶æ„ âœ…

```typescript
// AgenticOrchestrator è®¾è®¡
export class AgenticOrchestrator {
  private currentTask: MultiStepTask | null = null;  // âš ï¸ å†…å­˜çŠ¶æ€
  private sessionId: string;                          // âš ï¸ ä¼šè¯çŠ¶æ€
}
```

**é—®é¢˜**: âŒ **æœ‰çŠ¶æ€è®¾è®¡**
- ç¼–æ’å™¨åœ¨å†…å­˜ä¸­ç»´æŠ¤ä»»åŠ¡çŠ¶æ€
- æ— æ³•æ°´å¹³æ‰©å±•
- è¿›ç¨‹å´©æºƒå¯¼è‡´çŠ¶æ€ä¸¢å¤±

**å½±å“**:
- å•å®ä¾‹ä¸Šé™ï¼šçº¦ 100 å¹¶å‘ä»»åŠ¡ï¼ˆä¼°è®¡ï¼‰
- æ— æ³•å®æ–½è´Ÿè½½å‡è¡¡
- é«˜å¯ç”¨æ€§éš¾ä»¥å®ç°

**å»ºè®®**: ğŸ”§ **å¿…é¡»æ”¹è¿›**

```typescript
// æ”¹è¿›æ–¹æ¡ˆï¼šçŠ¶æ€å¤–éƒ¨åŒ–
interface TaskStateStore {
  save(taskId: string, state: MultiStepTask): Promise<void>;
  get(taskId: string): Promise<MultiStepTask | null>;
  delete(taskId: string): Promise<void>;
}

// ä½¿ç”¨ Redis / IndexedDB
class AgenticOrchestrator {
  private stateStore: TaskStateStore;

  async executeTask(...) {
    await this.stateStore.save(taskId, task);
    // æ‰§è¡Œé€»è¾‘
  }
}
```

#### æœåŠ¡æ‹†åˆ†æ½œåŠ› âœ…

**å½“å‰æ¶æ„**:
```
Electron Main Process
â”œâ”€â”€ API Server
â”œâ”€â”€ Document Service
â”œâ”€â”€ AI Service
â””â”€â”€ Storage Service
```

**æœªæ¥æ‹†åˆ†è·¯å¾„**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  API Gateway    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚         â”‚         â”‚         â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â” â”Œâ”€â”€â”€â–¼â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â”
â”‚ Task  â”‚ â”‚ Doc â”‚ â”‚  AI   â”‚ â”‚Query â”‚
â”‚Serviceâ”‚ â”‚ Gen â”‚ â”‚Serviceâ”‚ â”‚Engineâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜
```

**è¯„ä¼°**: âœ… **è‰¯å¥½**
- æ¨¡å—è¾¹ç•Œæ¸…æ™°ï¼Œæ˜“äºæ‹†åˆ†
- API æŠ½è±¡å±‚å®Œå–„
- æ”¯æŒæ¸è¿›å¼å¾®æœåŠ¡åŒ–

### 2.2 å‚ç›´æ‰©å±•èƒ½åŠ›

#### æ€§èƒ½ä¼˜åŒ–ç­–ç•¥ âš ï¸

**æ–‡æ¡£ç”Ÿæˆ**:
```typescript
// å½“å‰å®ç°ï¼šä¸²è¡Œå¤„ç†
for (const row of data) {
  const doc = await generateDocument(row);
  documents.push(doc);
}
```

**é—®é¢˜**: âš ï¸ **æ— å¹¶è¡Œä¼˜åŒ–**
- 100 ä¸ªæ–‡æ¡£ Ã— 2ç§’/ä¸ª = 200 ç§’
- æ— æ³•åˆ©ç”¨å¤šæ ¸ CPU

**å»ºè®®**: ğŸ”§ **æ€§èƒ½ä¼˜åŒ–**

```typescript
// å¹¶è¡Œå¤„ç†
const chunks = chunkArray(data, 10);
const results = await Promise.all(
  chunks.map(chunk => processChunk(chunk))
);
```

**é¢„æœŸæå‡**: 10 å€ï¼ˆå‡è®¾ 10 æ ¸ï¼‰

#### AI è°ƒç”¨ä¼˜åŒ– âœ…

**ç¼“å­˜ç­–ç•¥**:
```typescript
interface CacheService {
  // å¤šçº§ç¼“å­˜
  memory: LRUCache;      // L1: å†…å­˜ (100MB)
  localStorage: IDB;     // L2: IndexedDB (1GB)
  remote?: Redis;        // L3: è¿œç¨‹ç¼“å­˜ (å¯é€‰)
}
```

**è¯„ä¼°**: âœ… **ä¼˜ç§€**
- ä¸‰çº§ç¼“å­˜è®¾è®¡åˆç†
- æ”¯æŒç¼“å­˜é¢„çƒ­å’Œå¤±æ•ˆ
- å‘½ä¸­ç‡é¢„ä¼°ï¼š60-80%

### 2.3 æ‰©å±•ç‚¹è®¾è®¡

#### æ’ä»¶æœºåˆ¶ âš ï¸

**å½“å‰**: âŒ **æ— æ’ä»¶ç³»ç»Ÿ**

**å»ºè®®**: ğŸ”§ **è®¾è®¡æ‰©å±•ç‚¹**

```typescript
interface DocumentProcessor {
  name: string;
  canHandle(format: DocumentFormat): boolean;
  process(input: ProcessInput): Promise<ProcessResult>;
}

// æ³¨å†Œæ’ä»¶
registry.register(new DOCXProcessor());
registry.register(new PDFProcessor());

// è¿è¡Œæ—¶é€‰æ‹©
const processor = registry.find(format);
await processor.process(input);
```

#### æ•°æ®æºæ‰©å±• âœ…

**è¯„ä¼°**: âœ… **è‰¯å¥½**
```typescript
enum DataSourceType {
  EXCEL = 'excel',
  CSV = 'csv',
  JSON = 'json',
  DATABASE = 'database',  // é¢„ç•™
  API = 'api',            // é¢„ç•™
  CUSTOM = 'custom'       // æ‰©å±•ç‚¹
}
```

---

## 3. æ€§èƒ½å’Œå¯é æ€§è¯„å®¡

### 3.1 æ€§èƒ½ç“¶é¢ˆåˆ†æ

#### WebSocket å®æ—¶é€šä¿¡ âš ï¸

**åœºæ™¯**: 100 å¹¶å‘ç”¨æˆ·ï¼Œæ¯ä¸ªç”¨æˆ· 10 ä¸ªä»»åŠ¡

**å½“å‰è®¾è®¡**:
```typescript
// æ¯ä¸ªä»»åŠ¡ä¸€ä¸ª WebSocket è¿æ¥
const ws = new WebSocket(`wss://api/${taskId}`);
```

**é—®é¢˜**: âš ï¸ **è¿æ¥æ•°çˆ†ç‚¸**
- 100 ç”¨æˆ· Ã— 10 ä»»åŠ¡ = 1000 è¿æ¥
- å•æœºè¿æ¥æ•°é™åˆ¶ï¼š~1024
- å†…å­˜å ç”¨ï¼š~100MB Ã— 1000 = 100GB

**å»ºè®®**: ğŸ”§ **è¿æ¥å¤ç”¨**

```typescript
// å•è¿æ¥å¤šè·¯å¤ç”¨
const ws = new WebSocket(`wss://api/user/${userId}`);

// è®¢é˜…å¤šä¸ªä»»åŠ¡
ws.send(JSON.stringify({
  action: 'subscribe',
  taskId: 'task_1'
}));

ws.send(JSON.stringify({
  action: 'subscribe',
  taskId: 'task_2'
}));

// æœåŠ¡ç«¯æ¨é€
{
  type: 'task:progress',
  taskId: 'task_1',
  progress: 50
}
```

**é¢„æœŸæå‡**: è¿æ¥æ•°å‡å°‘ 90%

#### å¤§æ•°æ®å¤„ç† âš ï¸

**åœºæ™¯**: 100,000 è¡Œ Excel æ–‡ä»¶

**å½“å‰å®ç°**:
```typescript
// å…¨é‡åŠ è½½åˆ°å†…å­˜
const data = await readExcel(file); // ~50MB
```

**é—®é¢˜**: âš ï¸ **å†…å­˜æº¢å‡ºé£é™©**
- å•æ–‡ä»¶ï¼š50MB
- 10 æ–‡ä»¶å¹¶å‘ï¼š500MB
- åŠ ä¸Šå¤„ç†é€»è¾‘ï¼š~2GB
- Electron é™åˆ¶ï¼š~4GB

**å»ºè®®**: ğŸ”§ **æµå¼å¤„ç†**

```typescript
// æµå¼è¯»å–
for await (const chunk of readExcelStream(file)) {
  const processed = await processChunk(chunk);
  await writeOutput(processed);
}
```

**é¢„æœŸæå‡**: å†…å­˜å ç”¨å‡å°‘ 80%

#### AI å“åº”æ—¶é—´ âš ï¸

**å½“å‰æŒ‡æ ‡**:
```typescript
const config = {
  timeoutPerStep: 30000,  // 30 ç§’
  totalTimeout: 300000    // 5 åˆ†é’Ÿ
};
```

**é—®é¢˜**: âš ï¸ **ç”¨æˆ·ä½“éªŒå·®**
- å•è½® AI è°ƒç”¨ï¼š5-10 ç§’
- 6 è½®åˆ†æï¼š30-60 ç§’
- æ€»è€—æ—¶ï¼š1-5 åˆ†é’Ÿ

**å»ºè®®**: ğŸ”§ **ä¼˜åŒ–ç­–ç•¥**

1. **å¹¶è¡ŒåŒ–ç‹¬ç«‹åˆ†æ**:
```typescript
// å¹¶è¡Œæ‰§è¡Œæ¨¡æ¿åˆ†æå’Œæ•°æ®åˆ†æ
const [template, data] = await Promise.all([
  analyzeTemplate(file),
  analyzeDataSource(file)
]);
```

2. **å¢é‡è¿”å›**:
```typescript
// æµå¼è¿”å›ç»“æœ
for await (const chunk of analyzeTemplate()) {
  updateUI(chunk);  // å®æ—¶æ›´æ–°è¿›åº¦
}
```

**é¢„æœŸæå‡**: æ€»è€—æ—¶å‡å°‘ 40%

### 3.2 å¯é æ€§ä¿éšœ

#### é”™è¯¯å¤„ç† âœ…

**OTAE è‡ªæ„ˆå¾ªç¯**:
```typescript
// Observe -> Think -> Act -> Evaluate
//           ^         |
//           |_________|  (é‡è¯•/ä¿®å¤)
```

**è¯„ä¼°**: âœ… **ä¼˜ç§€**
- è‡ªåŠ¨é”™è¯¯æ£€æµ‹
- å¤šç­–ç•¥ä¿®å¤ï¼ˆé‡è¯•ã€é™çº§ã€ç®€åŒ–ï¼‰
- è´¨é‡è¯„ä¼°å’Œåé¦ˆ

**è¦†ç›–ç‡**:
- âœ… AI æœåŠ¡å¤±è´¥
- âœ… ä»£ç æ‰§è¡Œé”™è¯¯
- âœ… æ•°æ®æ ¼å¼é”™è¯¯
- âœ… ç½‘ç»œè¶…æ—¶

**æå‡ç©ºé—´**:
- âš ï¸ ç¼ºå°‘æ–­è·¯å™¨æ¨¡å¼ï¼ˆCircuit Breakerï¼‰
- âš ï¸ ç¼ºå°‘é”™è¯¯èšåˆå’Œå‘Šè­¦

#### æ•°æ®ä¸€è‡´æ€§ âœ…

**äº‹åŠ¡æ”¯æŒ**:
```typescript
// æ–‡æ¡£ç”Ÿæˆäº‹åŠ¡
async function generateDocuments() {
  const transaction = await beginTransaction();

  try {
    for (const row of data) {
      const doc = await processRow(row);
      await save(doc, { transaction });
    }
    await commit(transaction);
  } catch (error) {
    await rollback(transaction);
    throw error;
  }
}
```

**è¯„ä¼°**: âœ… **è‰¯å¥½**
- æ”¯æŒ ACID äº‹åŠ¡
- å¤±è´¥è‡ªåŠ¨å›æ»š
- æ”¯æŒæ–­ç‚¹ç»­ä¼ 

### 3.3 å•ç‚¹æ•…éšœåˆ†æ

#### AI æœåŠ¡ä¾èµ– âŒ

**å½“å‰æ¶æ„**:
```
Application -> Zhipu AI (æ™ºè°±)
                â†“
            [å•ç‚¹æ•…éšœ]
```

**é£é™©**: âŒ **ä¸¥é‡**
- æ™ºè°± API æ•…éšœ = å…¨éƒ¨åŠŸèƒ½ä¸å¯ç”¨
- ç½‘ç»œä¸­æ–­ = æ— æ³•å·¥ä½œ
- é™æµ = ä»»åŠ¡é˜Ÿåˆ—å †ç§¯

**å»ºè®®**: ğŸ”§ **å¿…é¡»ä¿®å¤**

```typescript
// å¤š AI æä¾›å•†
interface AIProvider {
  name: string;
  priority: number;
  call(prompt: string): Promise<string>;
}

const providers: AIProvider[] = [
  { name: 'zhipu', priority: 1, call: zhipuCall },
  { name: 'openai', priority: 2, call: openaiCall },
  { name: 'anthropic', priority: 3, call: anthropicCall }
];

// è‡ªåŠ¨åˆ‡æ¢
async function callAI(prompt: string) {
  for (const provider of providers) {
    try {
      return await provider.call(prompt);
    } catch (error) {
      console.warn(`${provider.name} failed, trying next`);
    }
  }
  throw new Error('All AI providers failed');
}
```

#### Python è¿è¡Œæ—¶ âš ï¸

**ä¾èµ–**: Pyodide (æµè§ˆå™¨ä¸­è¿è¡Œ Python)

**é£é™©**: âš ï¸ **ä¸­ç­‰**
- Pyodide åŠ è½½æ—¶é—´ï¼š~5 ç§’
- å†…å­˜å ç”¨ï¼š~50MB
- æ€§èƒ½æŸå¤±ï¼š~50%

**å»ºè®®**: ğŸ”§ **æ¸è¿›å¼å¢å¼º**

```typescript
// ä¼˜å…ˆä½¿ç”¨ Node.js Python
if (isElectron) {
  // ä½¿ç”¨åŸç”Ÿ Pythonï¼ˆå¿«ï¼‰
  return await executePython(code);
}

// é™çº§åˆ° Pyodideï¼ˆæ…¢ä½†å¯ç”¨ï¼‰
if (isBrowser) {
  return await executePyodide(code);
}
```

---

## 4. æŠ€æœ¯æ ˆé€‰æ‹©è¯„å®¡

### 4.1 å‰ç«¯æŠ€æœ¯æ ˆ

#### React Flow âœ…

**ç”¨é€”**: å¯è§†åŒ–å·¥ä½œæµç¼–è¾‘å™¨

**è¯„ä¼°**: âœ… **ä¼˜ç§€**
- âœ… åŠŸèƒ½å¼ºå¤§ï¼Œæ”¯æŒè‡ªå®šä¹‰èŠ‚ç‚¹
- âœ… æ€§èƒ½è‰¯å¥½ï¼ˆ1000+ èŠ‚ç‚¹ï¼‰
- âœ… ç¤¾åŒºæ´»è·ƒ
- âœ… TypeScript æ”¯æŒå®Œå–„

**æ›¿ä»£æ–¹æ¡ˆå¯¹æ¯”**:

| æ–¹æ¡ˆ | ä¼˜åŠ¿ | åŠ£åŠ¿ | è¯„åˆ† |
|------|------|------|------|
| React Flow | åŠŸèƒ½å…¨ã€æ–‡æ¡£å¥½ | å­¦ä¹ æ›²çº¿é™¡ | 9/10 |
| Rete.js | æ’ä»¶ä¸°å¯Œ | ç»´æŠ¤ä¸æ´»è·ƒ | 7/10 |
| G6 (AntV) | æ€§èƒ½å¼º | API å¤æ‚ | 8/10 |

**ç»“è®º**: âœ… **æ¨èç»§ç»­ä½¿ç”¨**

#### Recharts âœ…

**ç”¨é€”**: æ•°æ®å¯è§†åŒ–å›¾è¡¨

**è¯„ä¼°**: âœ… **è‰¯å¥½**
- âœ… React å‹å¥½
- âœ… å£°æ˜å¼ API
- âœ… æ”¯æŒè‡ªå®šä¹‰
- âš ï¸ æ€§èƒ½ä¸€èˆ¬ï¼ˆå¤§æ•°æ®é›†ï¼‰

**å»ºè®®**: ğŸ”§ **æ€§èƒ½ä¼˜åŒ–**

```typescript
// è™šæ‹ŸåŒ–å¤§æ•°æ®é›†
import { ResponsiveContainer } from Recharts;

<ResponsiveContainer width="100%" height={400}>
  <LineChart data={largeData}>
    {/* ... */}
  </LineChart>
</ResponsiveContainer>
```

#### Monaco Editor âœ…

**ç”¨é€”**: ä»£ç ç¼–è¾‘å™¨

**è¯„ä¼°**: âœ… **ä¼˜ç§€**
- âœ… VS Code åŒæ¬¾
- âœ… TypeScript æ”¯æŒ
- âœ… æ™ºèƒ½æç¤º
- âš ï¸ åŒ…ä½“ç§¯å¤§ï¼ˆ~5MBï¼‰

**å»ºè®®**: âœ… **é€‚ç”¨**

### 4.2 åç«¯æŠ€æœ¯æ ˆ

#### Python æ‰§è¡Œå¼•æ“ âœ…

**é€‰æ‹©**: ä» JavaScript è¿ç§»åˆ° Python

**è¯„ä¼°**: âœ… **æ­£ç¡®å†³ç­–**
- âœ… æ•°æ®å¤„ç†ç”Ÿæ€æ›´å¼ºï¼ˆpandas, numpyï¼‰
- âœ… AI é›†æˆæ›´æ–¹ä¾¿
- âœ… æ€§èƒ½æ›´å¥½ï¼ˆæ•°å€¼è®¡ç®—ï¼‰
- âš ï¸ å¢åŠ å¤æ‚åº¦

**æ¶æ„**:
```typescript
// Node.js ä¸»è¿›ç¨‹
const python = spawn('python', ['script.py']);

// æ•°æ®ä¼ è¾“
python.stdin.write(JSON.stringify(data));
python.stdout.on('data', (result) => {
  console.log(JSON.parse(result));
});
```

**é£é™©**: âš ï¸ **è¿›ç¨‹ç®¡ç†**
- Python è¿›ç¨‹å´©æºƒæ¢å¤
- å†…å­˜æ³„æ¼æ£€æµ‹
- è¿›ç¨‹æ± ç®¡ç†

**å»ºè®®**: ğŸ”§ **å®Œå–„ç›‘æ§**

```typescript
// è¿›ç¨‹å¥åº·æ£€æŸ¥
class PythonProcessPool {
  private processes: WorkerProcess[] = [];

  async execute(code: string) {
    const worker = await this.acquire();
    try {
      return await worker.execute(code);
    } finally {
      this.release(worker);
    }
  }

  private async healthCheck(worker: WorkerProcess) {
    if (worker.isDead()) {
      await this.restart(worker);
    }
  }
}
```

#### AI SDK âœ…

**é€‰æ‹©**: @anthropic-ai/sdk + æ™ºè°± AI

**è¯„ä¼°**: âœ… **åˆç†**
- âœ… ç»Ÿä¸€æ¥å£
- âœ… æ˜“äºåˆ‡æ¢æä¾›å•†
- âœ… ç±»å‹å®‰å…¨

**æ›¿ä»£æ–¹æ¡ˆ**: âœ… **å·²è€ƒè™‘**

```typescript
// æ”¯æŒå¤šä¸ªæä¾›å•†
type AIProvider = 'zhipu' | 'openai' | 'anthropic';

function createClient(provider: AIProvider) {
  switch (provider) {
    case 'zhipu':
      return new Anthropic({ baseURL: 'https://open.bigmodel.cn/api/anthropic' });
    case 'openai':
      return new OpenAI();
    case 'anthropic':
      return new Anthropic();
  }
}
```

### 4.3 åŸºç¡€è®¾æ–½æŠ€æœ¯æ ˆ

#### Pyodide âš ï¸

**ç”¨é€”**: æµè§ˆå™¨ä¸­è¿è¡Œ Python

**è¯„ä¼°**: âš ï¸ **æœ‰æ¡ä»¶æ¨è**
- âœ… æ— éœ€åç«¯
- âœ… æ•°æ®å®‰å…¨ï¼ˆæœ¬åœ°æ‰§è¡Œï¼‰
- âŒ åŠ è½½æ—¶é—´ ~5 ç§’
- âŒ å†…å­˜å ç”¨ ~50MB
- âŒ æ€§èƒ½æŸå¤± ~50%

**é£é™©**: âŒ **æŠ€æœ¯é”å®š**
- è¿ç§»åˆ°å…¶ä»–æ–¹æ¡ˆå›°éš¾
- Pyodide ç”Ÿæ€æœ‰é™
- è°ƒè¯•å›°éš¾

**å»ºè®®**: ğŸ”§ **æ˜ç¡®ä½¿ç”¨è¾¹ç•Œ**

```typescript
// ä»…åœ¨å¿…è¦æ—¶ä½¿ç”¨
if (feature === 'advanced-analysis') {
  // å¿…é¡»ç”¨ Pythonï¼ˆå¤æ‚è®¡ç®—ï¼‰
  return await executePyodide(code);
} else {
  // ä¼˜å…ˆç”¨ JavaScriptï¼ˆç®€å•æ“ä½œï¼‰
  return await executeJS(code);
}
```

#### Electron âœ…

**è¯„ä¼°**: âœ… **é€‚åˆåœºæ™¯**
- âœ… æ¡Œé¢åº”ç”¨éœ€æ±‚
- âœ… æœ¬åœ°æ–‡ä»¶è®¿é—®
- âœ… ç¦»çº¿å·¥ä½œèƒ½åŠ›
- âš ï¸ å®‰è£…åŒ…å¤§ï¼ˆ~200MBï¼‰

**æ›¿ä»£æ–¹æ¡ˆå¯¹æ¯”**:

| æ–¹æ¡ˆ | ä¼˜åŠ¿ | åŠ£åŠ¿ | è¯„åˆ† |
|------|------|------|------|
| Electron | ç”Ÿæ€æˆç†Ÿã€è·¨å¹³å° | ä½“ç§¯å¤§ã€èµ„æºå ç”¨ | 8/10 |
| Tauri | ä½“ç§¯å°ã€æ€§èƒ½å¥½ | ç”Ÿæ€ä¸æˆç†Ÿ | 7/10 |
| Web App | æ— éœ€å®‰è£… | åŠŸèƒ½å—é™ | 5/10 |

**ç»“è®º**: âœ… **é€‚ç”¨å½“å‰éœ€æ±‚**

---

## 5. æ¶æ„é£é™©æ¸…å•

### 5.1 é«˜é£é™© (é˜»å¡å‘å¸ƒ)

| é£é™© | å½±å“ | æ¦‚ç‡ | ä¼˜å…ˆçº§ | ç¼“è§£æªæ–½ |
|------|------|------|--------|---------|
| **AI æœåŠ¡å•ç‚¹æ•…éšœ** | å…¨éƒ¨åŠŸèƒ½ä¸å¯ç”¨ | é«˜ | P0 | å®æ–½å¤šæä¾›å•†åˆ‡æ¢ |
| **å‰åç«¯ç±»å‹ä¸ä¸€è‡´** | è¿è¡Œæ—¶é”™è¯¯ã€ç±»å‹å¤±æ•ˆ | é«˜ | P0 | åˆ›å»ºå…±äº«ç±»å‹åº“ |
| **çŠ¶æ€æœºå†…å­˜å­˜å‚¨** | æ— æ³•æ°´å¹³æ‰©å±•ã€æ•°æ®ä¸¢å¤± | ä¸­ | P0 | å¤–éƒ¨åŒ–çŠ¶æ€åˆ° Redis/IndexedDB |
| **WebSocket è¿æ¥æ•°çˆ†ç‚¸** | æœåŠ¡å´©æºƒã€å†…å­˜æº¢å‡º | é«˜ | P0 | å®æ–½è¿æ¥å¤ç”¨ |

### 5.2 ä¸­é£é™© (çº³å…¥ Phase 1)

| é£é™© | å½±å“ | æ¦‚ç‡ | ä¼˜å…ˆçº§ | ç¼“è§£æªæ–½ |
|------|------|------|--------|---------|
| **å¤§æ•°æ®å†…å­˜æº¢å‡º** | åº”ç”¨å´©æºƒ | ä¸­ | P1 | æµå¼å¤„ç†ã€åˆ†é¡µåŠ è½½ |
| **AI å“åº”æ—¶é—´è¿‡é•¿** | ç”¨æˆ·ä½“éªŒå·® | é«˜ | P1 | å¹¶è¡ŒåŒ–ã€å¢é‡è¿”å› |
| **æ–‡æ¡£ç”Ÿæˆä¸²è¡Œå¤„ç†** | æ€§èƒ½ç“¶é¢ˆ | ä¸­ | P1 | å¹¶è¡Œå¤„ç†ã€ä»»åŠ¡é˜Ÿåˆ— |
| **Pyodide æ€§èƒ½æŸå¤±** | å“åº”å˜æ…¢ | é«˜ | P1 | ä¼˜å…ˆä½¿ç”¨ Node.js Python |
| **ç¼ºå°‘æ–­è·¯å™¨æ¨¡å¼** | çº§è”æ•…éšœ | ä¸­ | P1 | å®æ–½æ–­è·¯å™¨å’Œé™çº§ |

### 5.3 ä½é£é™© (åç»­è¿­ä»£)

| é£é™© | å½±å“ | æ¦‚ç‡ | ä¼˜å…ˆçº§ | ç¼“è§£æªæ–½ |
|------|------|------|--------|---------|
| **æ¨¡å—è¾¹ç•Œæ¨¡ç³Š** | ç»´æŠ¤å›°éš¾ | ä½ | P2 | é‡æ„æ¨¡å—è¾¹ç•Œ |
| **ç¼ºå°‘æ’ä»¶ç³»ç»Ÿ** | æ‰©å±•å—é™ | ä½ | P2 | è®¾è®¡æ‰©å±•ç‚¹ |
| **ç›‘æ§æŒ‡æ ‡ä¸è¶³** | é—®é¢˜å®šä½å›°éš¾ | ä¸­ | P2 | å®Œå–„å¯è§‚æµ‹æ€§ |
| **æµ‹è¯•è¦†ç›–ç‡ä¸è¶³** | è´¨é‡é£é™© | ä½ | P2 | æå‡æµ‹è¯•è¦†ç›–ç‡ |

---

## 6. æ¶æ„ä¼˜åŒ–å»ºè®®

### 6.1 ç«‹å³æ‰§è¡Œ (å¯åŠ¨ Phase 1 å‰)

#### 1. ç»Ÿä¸€ç±»å‹ç³»ç»Ÿ

```typescript
// åˆ›å»º packages/shared-types
// packages/shared-types/src/index.ts

// æ ¸å¿ƒç±»å‹
export enum ProcessingStage {
  TEMPLATE_ANALYSIS = 'template_analysis',
  DATA_ANALYSIS = 'data_analysis',
  // ...
}

export interface DocumentGenerationTask {
  id: string;
  status: ExecutionStatus;
  // ...
}

// ä½¿ç”¨
// å‰ç«¯: import { ProcessingStage } from '@shared-types';
// åç«¯: import { ProcessingStage } from '@shared-types';
```

**ä¼˜å…ˆçº§**: P0
**å·¥ä½œé‡**: 2 å¤©
**æ”¶ç›Š**: æ¶ˆé™¤ç±»å‹ä¸åŒ¹é…é£é™©

#### 2. AI æœåŠ¡é™çº§ç­–ç•¥

```typescript
class AIProviderManager {
  private providers: AIProvider[] = [
    new ZhipuProvider(),
    new OpenAIProvider(),    // å¤‡é€‰
    new AnthropicProvider()  // å¤‡é€‰
  ];

  async call(prompt: string): Promise<string> {
    for (const provider of this.providers) {
      try {
        return await provider.call(prompt);
      } catch (error) {
        this.metrics.recordFailure(provider.name);
        continue;
      }
    }
    throw new Error('All AI providers failed');
  }
}
```

**ä¼˜å…ˆçº§**: P0
**å·¥ä½œé‡**: 3 å¤©
**æ”¶ç›Š**: æ¶ˆé™¤å•ç‚¹æ•…éšœé£é™©

#### 3. çŠ¶æ€å¤–éƒ¨åŒ–

```typescript
interface TaskStateStore {
  save(taskId: string, state: MultiStepTask): Promise<void>;
  get(taskId: string): Promise<MultiStepTask>;
  delete(taskId: string): Promise<void>;
}

// Redis å®ç° (Electron ä¸»è¿›ç¨‹)
class RedisTaskStore implements TaskStateStore {
  private client = redis.createClient();

  async save(taskId: string, state: MultiStepTask) {
    await this.client.setex(
      `task:${taskId}`,
      3600,  // 1 å°æ—¶è¿‡æœŸ
      JSON.stringify(state)
    );
  }
}

// IndexedDB å®ç° (æ¸²æŸ“è¿›ç¨‹)
class IndexedDBTaskStore implements TaskStateStore {
  private db = await openDB('ExcelMind', 1);

  async save(taskId: string, state: MultiStepTask) {
    await this.db.put('tasks', state, taskId);
  }
}
```

**ä¼˜å…ˆçº§**: P0
**å·¥ä½œé‡**: 5 å¤©
**æ”¶ç›Š**: æ”¯æŒæ°´å¹³æ‰©å±•å’Œå®¹ç¾æ¢å¤

### 6.2 çº³å…¥ Phase 1 æ‰§è¡Œ

#### 4. WebSocket è¿æ¥å¤ç”¨

```typescript
class WebSocketManager {
  private connections = new Map<string, WebSocket>();

  subscribe(userId: string, taskId: string, callback: Callback) {
    let ws = this.connections.get(userId);

    if (!ws) {
      ws = new WebSocket(`wss://api/user/${userId}`);
      this.connections.set(userId, ws);
    }

    // å‘é€è®¢é˜…è¯·æ±‚
    ws.send(JSON.stringify({
      action: 'subscribe',
      taskId
    }));

    // ç›‘å¬æ¶ˆæ¯
    ws.addEventListener('message', (event) => {
      const data = JSON.parse(event.data);
      if (data.taskId === taskId) {
        callback(data);
      }
    });
  }
}
```

**ä¼˜å…ˆçº§**: P1
**å·¥ä½œé‡**: 3 å¤©
**æ”¶ç›Š**: æ”¯æŒ 100+ å¹¶å‘ç”¨æˆ·

#### 5. æµå¼æ•°æ®å¤„ç†

```typescript
async function* streamExcel(file: File): AsyncGenerator<any[]> {
  const workbook = await ExcelJS.workbook.xlsx.read(file);
  const worksheet = workbook.worksheets[0];

  const batchSize = 100;
  let batch = [];

  for await (const row of worksheet) {
    batch.push(row);
    if (batch.length >= batchSize) {
      yield batch;
      batch = [];
    }
  }

  if (batch.length > 0) {
    yield batch;
  }
}

// ä½¿ç”¨
for await (const chunk of streamExcel(file)) {
  await processChunk(chunk);
}
```

**ä¼˜å…ˆçº§**: P1
**å·¥ä½œé‡**: 4 å¤©
**æ”¶ç›Š**: å†…å­˜å ç”¨å‡å°‘ 80%

#### 6. å¹¶è¡Œæ–‡æ¡£ç”Ÿæˆ

```typescript
class DocumentGenerationPool {
  private workers: Worker[];

  constructor(concurrency: number = 10) {
    this.workers = Array.from({ length: concurrency }, () =>
      new Worker('./document-worker.js')
    );
  }

  async generateAll(data: any[]): Promise<Document[]> {
    const chunks = chunkArray(data, this.workers.length);

    const results = await Promise.all(
      chunks.map((chunk, i) =>
        this.workers[i].execute(chunk)
      )
    );

    return results.flat();
  }
}
```

**ä¼˜å…ˆçº§**: P1
**å·¥ä½œé‡**: 5 å¤©
**æ”¶ç›Š**: æ€§èƒ½æå‡ 10 å€

### 6.3 åç»­è¿­ä»£ä¼˜åŒ–

#### 7. æ¶æ„å†³ç­–è®°å½• (ADR)

```markdown
# ADR-001: é€‰æ‹© Python ä½œä¸ºæ•°æ®å¤„ç†å¼•æ“

## çŠ¶æ€
å·²æ¥å—

## èƒŒæ™¯
éœ€è¦å¤„ç†å¤§é‡ Excel æ•°æ®ï¼ŒJavaScript æ€§èƒ½ä¸è¶³ã€‚

## å†³ç­–
ä½¿ç”¨ Python ä½œä¸ºä¸»è¦æ•°æ®å¤„ç†å¼•æ“ã€‚

## åæœ
- æ­£é¢ï¼šæ€§èƒ½æå‡ã€ç”Ÿæ€ä¸°å¯Œ
- è´Ÿé¢ï¼šå¢åŠ å¤æ‚åº¦ã€éœ€è¦è¿›ç¨‹ç®¡ç†
```

**ä¼˜å…ˆçº§**: P2
**å·¥ä½œé‡**: æŒç»­
**æ”¶ç›Š**: çŸ¥è¯†æ²‰æ·€ã€å†³ç­–é€æ˜

#### 8. å¯è§‚æµ‹æ€§å¢å¼º

```typescript
class MetricsCollector {
  private registry = new Registry();

  // AI è°ƒç”¨æŒ‡æ ‡
  aiCalls = this.registry.createCounter('ai_calls_total');
  aiFailures = this.registry.createCounter('ai_failures_total');
  aiLatency = this.registry.createHistogram('ai_latency_seconds');

  // æ–‡æ¡£ç”ŸæˆæŒ‡æ ‡
  docsGenerated = this.registry.createCounter('docs_generated_total');
  docsFailed = this.registry.createCounter('docs_failed_total');
  docsLatency = this.registry.createHistogram('docs_latency_seconds');

  // è®°å½•
  recordAICall(provider: string, duration: number, success: boolean) {
    this.aiCalls.inc({ provider });
    this.aiLatency.observe(duration, { provider });

    if (!success) {
      this.aiFailures.inc({ provider });
    }
  }
}
```

**ä¼˜å…ˆçº§**: P2
**å·¥ä½œé‡**: 3 å¤©
**æ”¶ç›Š**: å¿«é€Ÿå®šä½é—®é¢˜ã€æ€§èƒ½ä¼˜åŒ–

#### 9. æµ‹è¯•è¦†ç›–ç‡æå‡

```typescript
// ç›®æ ‡è¦†ç›–ç‡
{
  "statements": 90,
  "branches": 85,
  "functions": 95,
  "lines": 90
}

// å…³é”®æµ‹è¯•
describe('AgenticOrchestrator', () => {
  it('should handle AI service failure', async () => {
    // æµ‹è¯• AI æ•…éšœé™çº§
  });

  it('should recover from code execution error', async () => {
    // æµ‹è¯•è‡ªæ„ˆæœºåˆ¶
  });

  it('should scale to 100 concurrent tasks', async () => {
    // æµ‹è¯•æ°´å¹³æ‰©å±•
  });
});
```

**ä¼˜å…ˆçº§**: P2
**å·¥ä½œé‡**: æŒç»­
**æ”¶ç›Š**: è´¨é‡ä¿éšœã€é‡æ„ä¿¡å¿ƒ

---

## 7. Go/No-Go å†³ç­–

### å†³ç­–çŸ©é˜µ

| ç»´åº¦ | æƒé‡ | è¯„åˆ† (0-10) | åŠ æƒåˆ† |
|------|------|-------------|--------|
| **æ¶æ„ä¸€è‡´æ€§** | 20% | 7 | 1.4 |
| **å¯æ‰©å±•æ€§** | 20% | 8 | 1.6 |
| **æ€§èƒ½å’Œå¯é æ€§** | 25% | 7 | 1.75 |
| **æŠ€æœ¯æ ˆåˆç†æ€§** | 15% | 8 | 1.2 |
| **é£é™©å¯æ§æ€§** | 20% | 7 | 1.4 |
| **æ€»åˆ†** | 100% | - | **7.35/10** |

### å†³ç­–: âš ï¸ **æœ‰æ¡ä»¶é€šè¿‡ (Conditional Go)**

**é€šè¿‡æ¡ä»¶**:

1. **å¿…é¡»å®Œæˆ** (é˜»å¡ Phase 1 å¯åŠ¨):
   - âœ… ç»Ÿä¸€å‰åç«¯ç±»å‹ç³»ç»Ÿ
   - âœ… å®æ–½ AI æœåŠ¡é™çº§ç­–ç•¥
   - âœ… å¤–éƒ¨åŒ–çŠ¶æ€å­˜å‚¨

2. **åº”å®Œæˆ** (çº³å…¥ Phase 1):
   - âš ï¸ WebSocket è¿æ¥å¤ç”¨
   - âš ï¸ å¤§æ•°æ®æµå¼å¤„ç†
   - âš ï¸ å¹¶è¡Œæ–‡æ¡£ç”Ÿæˆ

3. **å»ºè®®å®Œæˆ** (åç»­è¿­ä»£):
   - ğŸ“‹ æ¶æ„å†³ç­–è®°å½•
   - ğŸ“‹ å¯è§‚æµ‹æ€§å¢å¼º
   - ğŸ“‹ æµ‹è¯•è¦†ç›–ç‡æå‡

### é£é™©è¯„ä¼°

| é£é™©ç±»å‹ | å½“å‰çŠ¶æ€ | ç›®æ ‡çŠ¶æ€ | ç¼“è§£è®¡åˆ’ |
|---------|---------|---------|---------|
| æŠ€æœ¯é£é™© | é«˜ | ä¸­ | å®Œæˆä¸Šè¿° P0 ä»»åŠ¡ |
| ä¸šåŠ¡é£é™© | ä¸­ | ä½ | åˆ†é˜¶æ®µä¸Šçº¿ã€ç°åº¦å‘å¸ƒ |
| è¿›åº¦é£é™© | ä¸­ | ä¸­ | é¢„ç•™ 20% ç¼“å†²æ—¶é—´ |

---

## 8. å®æ–½è·¯çº¿å›¾

### Phase 0: åŸºç¡€æ”¹è¿› (1 å‘¨)

```
Week 1:
â”œâ”€â”€ Day 1-2: ç»Ÿä¸€ç±»å‹ç³»ç»Ÿ
â”œâ”€â”€ Day 3-4: AI æœåŠ¡é™çº§ç­–ç•¥
â”œâ”€â”€ Day 5:   çŠ¶æ€å¤–éƒ¨åŒ–è®¾è®¡
â””â”€â”€ Day 6-7: ä»£ç å®¡æŸ¥å’Œæµ‹è¯•
```

**äº¤ä»˜ç‰©**:
- å…±äº«ç±»å‹åº“ `@shared-types`
- AI æä¾›å•†ç®¡ç†å™¨
- Redis/IndexedDB çŠ¶æ€å­˜å‚¨

### Phase 1: æ ¸å¿ƒåŠŸèƒ½ (2-3 å‘¨)

```
Week 2-3:
â”œâ”€â”€ WebSocket è¿æ¥å¤ç”¨
â”œâ”€â”€ æµå¼æ•°æ®å¤„ç†
â”œâ”€â”€ å¹¶è¡Œæ–‡æ¡£ç”Ÿæˆ
â””â”€â”€ æ€§èƒ½æµ‹è¯•å’Œä¼˜åŒ–

Week 4:
â”œâ”€â”€ é›†æˆæµ‹è¯•
â”œâ”€â”€ æ€§èƒ½åŸºå‡†æµ‹è¯•
â””â”€â”€ æ–‡æ¡£å®Œå–„
```

**äº¤ä»˜ç‰©**:
- WebSocket ç®¡ç†å™¨
- æµå¼å¤„ç†ç®¡é“
- å¹¶è¡Œå¤„ç†æ± 
- æ€§èƒ½æµ‹è¯•æŠ¥å‘Š

### Phase 2: ä¼˜åŒ–å¢å¼º (1-2 å‘¨)

```
Week 5:
â”œâ”€â”€ å¯è§‚æµ‹æ€§å¢å¼º
â”œâ”€â”€ ç›‘æ§ä»ªè¡¨ç›˜
â””â”€â”€ å‘Šè­¦é…ç½®

Week 6:
â”œâ”€â”€ æµ‹è¯•è¦†ç›–ç‡æå‡
â”œâ”€â”€ æ–‡æ¡£å®Œå–„
â””â”€â”€ çŸ¥è¯†åº“å»ºè®¾
```

**äº¤ä»˜ç‰©**:
- ç›‘æ§ç³»ç»Ÿ
- å‘Šè­¦è§„åˆ™
- æµ‹è¯•æŠ¥å‘Š
- æ¶æ„æ–‡æ¡£

---

## 9. å…³é”®æŒ‡æ ‡ (KPI)

### æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | å½“å‰å€¼ | ç›®æ ‡å€¼ | æµ‹é‡æ–¹æ³• |
|------|--------|--------|---------|
| AI å“åº”æ—¶é—´ | 5-10s | < 3s | P95 å»¶è¿Ÿ |
| æ–‡æ¡£ç”Ÿæˆé€Ÿåº¦ | 2s/ä¸ª | < 1s | ååé‡ |
| WebSocket è¿æ¥æ•° | 1000 | 100 | å¹¶å‘è¿æ¥ |
| å†…å­˜å ç”¨ | 2GB | < 500MB | å³°å€¼å†…å­˜ |
| ä»»åŠ¡æˆåŠŸç‡ | 85% | > 95% | æˆåŠŸç‡ |

### å¯é æ€§æŒ‡æ ‡

| æŒ‡æ ‡ | ç›®æ ‡å€¼ | æµ‹é‡æ–¹æ³• |
|------|--------|---------|
| ç³»ç»Ÿå¯ç”¨æ€§ | > 99% | è¿è¡Œæ—¶é—´ / æ€»æ—¶é—´ |
| MTBF (å¹³å‡æ•…éšœé—´éš”) | > 720h | æ•…éšœé—´éš”æ—¶é—´ |
| MTTR (å¹³å‡æ¢å¤æ—¶é—´) | < 10min | æ•…éšœæ¢å¤æ—¶é—´ |
| æ•°æ®ä¸€è‡´æ€§ | 100% | æ ¡éªŒé€šè¿‡ç‡ |

### è´¨é‡æŒ‡æ ‡

| æŒ‡æ ‡ | ç›®æ ‡å€¼ | æµ‹é‡æ–¹æ³• |
|------|--------|---------|
| æµ‹è¯•è¦†ç›–ç‡ | > 90% | ä»£ç è¦†ç›–ç‡ |
| ä»£ç å®¡æŸ¥ç‡ | 100% | PR å®¡æŸ¥ç‡ |
| Bug å¯†åº¦ | < 1/KLOC | Bug æ•° / åƒè¡Œä»£ç  |
| æŠ€æœ¯å€ºåŠ¡æ¯”ç‡ | < 5% | æŠ€æœ¯å€ºåŠ¡ / æ€»ä»£ç  |

---

## 10. ç»“è®º

### æ€»ä½“è¯„ä»·

ExcelMind AI Phase 2 æ¶æ„è®¾è®¡**æ•´ä½“è‰¯å¥½**ï¼Œå…·å¤‡ä»¥ä¸‹ä¼˜åŠ¿ï¼š

1. âœ… **æ¶æ„åˆ†å±‚æ¸…æ™°**ï¼Œç¬¦åˆ DDD åŸåˆ™
2. âœ… **æŠ€æœ¯æ ˆåˆç†**ï¼Œé€‚åˆå½“å‰ä¸šåŠ¡åœºæ™¯
3. âœ… **å¯æ‰©å±•æ€§è‰¯å¥½**ï¼Œæ”¯æŒæœªæ¥åŠŸèƒ½æ¼”è¿›
4. âœ… **è‡ªæ„ˆæœºåˆ¶å®Œå–„**ï¼Œå¯é æ€§ä¿éšœåˆ°ä½

ä½†åŒæ—¶ä¹Ÿå­˜åœ¨éœ€è¦è§£å†³çš„é—®é¢˜ï¼š

1. âš ï¸ **ç±»å‹ç³»ç»Ÿä¸ç»Ÿä¸€**ï¼Œå½±å“ç±»å‹å®‰å…¨
2. âš ï¸ **å•ç‚¹æ•…éšœé£é™©**ï¼Œéœ€è¦é™çº§ç­–ç•¥
3. âš ï¸ **æ€§èƒ½ç“¶é¢ˆæ˜æ˜¾**ï¼Œéœ€è¦ä¼˜åŒ–æå‡

### æœ€ç»ˆå»ºè®®

**å»ºè®®åœ¨å®Œæˆä»¥ä¸‹æ”¹è¿›åå¯åŠ¨ Phase 1**:

1. âœ… åˆ›å»ºå…±äº«ç±»å‹åº“
2. âœ… å®æ–½ AI æœåŠ¡é™çº§
3. âœ… å¤–éƒ¨åŒ–çŠ¶æ€å­˜å‚¨

**é¢„è®¡æ”¹è¿›æ—¶é—´**: 1 å‘¨

**é¢„è®¡æ€»ä½“é£é™©**: ä» "é«˜" é™è‡³ "ä¸­"

**å»ºè®®å†³ç­–**: **æœ‰æ¡ä»¶é€šè¿‡ (Conditional Go)**

---

## é™„å½•

### A. æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ç”¨æˆ·ç•Œé¢å±‚                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Mapping  â”‚  â”‚ Document â”‚  â”‚  Query   â”‚  â”‚ Monitor  â”‚   â”‚
â”‚  â”‚  Editor  â”‚  â”‚  Space   â”‚  â”‚Visualizerâ”‚  â”‚ Panel    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚ REST API / WebSocket
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        åº”ç”¨æœåŠ¡å±‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚         IntelligentDocumentService                â”‚     â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚     â”‚
â”‚  â”‚  â”‚       AgenticOrchestrator (OTAE)        â”‚     â”‚     â”‚
â”‚  â”‚  â”‚  Observe -> Think -> Act -> Evaluate   â”‚     â”‚     â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        é¢†åŸŸæ¨¡å‹å±‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ MappingSchemaâ”‚  â”‚ Processing   â”‚  â”‚    Task      â”‚     â”‚
â”‚  â”‚      V2      â”‚  â”‚   Stage      â”‚  â”‚  Context     â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        åŸºç¡€è®¾æ–½å±‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   AI   â”‚  â”‚ Cache  â”‚  â”‚Storage â”‚  â”‚ Python â”‚  â”‚Monitorâ”‚ â”‚
â”‚  â”‚Service â”‚  â”‚Service â”‚  â”‚Service â”‚  â”‚Runtime â”‚  â”‚System â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### B. æ•°æ®æµå›¾

```
ç”¨æˆ·è¾“å…¥
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‰ç«¯è¡¨å• â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚ HTTP POST /api/v1/tasks
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TaskControllerâ”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ IntelligentDocumentService  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      AgenticOrchestrator (OTAE)       â”‚
â”‚                                       â”‚
â”‚  1. Observe  (åˆ†ææ•°æ®ç»“æ„)           â”‚
â”‚  2. Think     (AI ç”Ÿæˆè®¡åˆ’)           â”‚
â”‚  3. Act       (æ‰§è¡Œ Python ä»£ç )      â”‚
â”‚  4. Evaluate  (è¯„ä¼°ç»“æœè´¨é‡)          â”‚
â”‚      â”‚                               â”‚
â”‚      â””â”€â”€â–º ä¸é€šè¿‡? â”€â”€â–º ä¿®å¤ â”€â”€â–º é‡è¯•  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    DocxtemplaterService        â”‚
â”‚  (æ‰¹é‡ç”Ÿæˆ Word æ–‡æ¡£)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Storage Service             â”‚
â”‚  (ä¿å­˜åˆ°æœ¬åœ°/äº‘ç«¯)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
      ç”¨æˆ·ä¸‹è½½
```

### C. éƒ¨ç½²æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Electron åº”ç”¨                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚               æ¸²æŸ“è¿›ç¨‹ (Renderer)                     â”‚  â”‚
â”‚  â”‚  React UI + TypeScript + Tailwind CSS                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                             â”‚ IPC                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚               ä¸»è¿›ç¨‹ (Main)                           â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚  â”‚
â”‚  â”‚  â”‚  API Server  â”‚  â”‚  File System â”‚                 â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚  â”‚
â”‚  â”‚         â”‚                                           â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚  â”‚
â”‚  â”‚  â”‚  IntelligentDocumentService    â”‚                â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚  â”‚
â”‚  â”‚         â”‚                                            â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚  â”‚
â”‚  â”‚  â”‚ Python Runtimeâ”‚  â”‚ IndexedDB  â”‚                  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ HTTP / WebSocket
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Zhipu AI API                  â”‚
â”‚  (æ™ºè°± AI å¤§æ¨¡å‹æœåŠ¡)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**æ–‡æ¡£ç»“æŸ**

**ä¸‹ä¸€æ­¥è¡ŒåŠ¨**:
1. å¬å¼€æ¶æ„è¯„å®¡ä¼šè®®ï¼Œè®¨è®ºæœ¬æŠ¥å‘Š
2. ç¡®å®šæ”¹è¿›ä»»åŠ¡çš„ä¼˜å…ˆçº§å’Œåˆ†å·¥
3. åˆ›å»ºè¯¦ç»†çš„å®æ–½è®¡åˆ’
4. å¯åŠ¨ Phase 0 æ”¹è¿›å·¥ä½œ

**æŠ¥å‘Šç»´æŠ¤**:
- æ¯å‘¨æ›´æ–°è¿›åº¦
- æ¯æœˆé‡æ–°è¯„ä¼°é£é™©
- æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´å»ºè®®
