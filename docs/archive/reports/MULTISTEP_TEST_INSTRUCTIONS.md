# 多步分析系统 - 测试启动指南

**准备就绪！** - 所有环境已配置完成，可以开始测试。

---

## ✅ 环境检查

| 项目 | 状态 | 说明 |
|------|------|------|
| Vite 开发服务器 | ✅ 运行中 | 端口 3000 |
| 测试数据文件 | ✅ 已生成 | 5 个测试文件就绪 |
| Python 环境 | ✅ 就绪 | Python + pandas 已安装 |
| AI 服务配置 | ✅ 完成 | 智谱 AI 已配置 |

---

## 🚀 启动步骤

### 方法 1: 使用 npm 脚本（推荐）

在项目根目录执行：

```bash
npm run electron
```

这将启动 Electron 应用，自动连接到 Vite 开发服务器。

### 方法 2: 使用开发模式（带热重载）

```bash
npm run electron-dev
```

这将同时启动 Vite 服务器和 Electron 应用。

---

## 📁 测试文件位置

所有测试文件位于：`public/test-files/`

### 文件列表

1. **test-simple.xlsx** (5.8 KB)
   - **用途**: 基础功能测试
   - **内容**: 简单销售数据（日期、产品、销售额）
   - **测试命令**:
     - "计算总销售额"
     - "按产品分组统计销售额"
     - "找出销售额最高的产品"

2. **test-complex.xlsx** (6.7 KB)
   - **用途**: 错误修复测试
   - **内容**: 3个Sheet（员工信息、部门预算、考勤记录）
   - **特点**: 包含空值、缺失数据
   - **测试命令**:
     - "计算每个部门的平均工资"
     - "统计部门预算使用情况"
     - "关联员工信息和考勤记录"

3. **test-edge.xlsx** (5.8 KB)
   - **用途**: 质量评估测试
   - **内容**: 库存数据
   - **特点**: 包含空值、负值、零值、无效分类
   - **测试命令**:
     - "过滤无效数据"
     - "计算库存总价值"
     - "按分类统计库存"

4. **test-audit.xlsx** (7.9 KB)
   - **用途**: 实际业务场景测试
   - **内容**: 财务审计凭证（50条记录）
   - **特点**: 模拟真实审计数据
   - **测试命令**:
     - "计算借方和贷方总额"
     - "检查借贷平衡"
     - "按科目统计发生额"

5. **test-aggregation.xlsx** (7.3 KB)
   - **用途**: 多Sheet关联测试
   - **内容**: 3个关联Sheet（订单、客户、产品）
   - **特点**: 需要跨Sheet数据关联
   - **测试命令**:
     - "计算每个客户的总订单金额"
     - "统计各地区的销售情况"
     - "关联三个Sheet的数据"

---

## 🧪 快速测试流程

### 第一步: 启动应用

```bash
npm run electron
```

等待应用窗口打开。

### 第二步: 上传测试文件

1. 点击应用中的"上传文件"按钮
2. 选择 `public/test-files/test-simple.xlsx`
3. 确认文件加载成功

### 第三步: 执行分析

1. 在命令输入框输入: `计算总销售额`
2. **确保"智能模式"已勾选**（默认勾选）
3. 点击"执行转换"按钮

### 第四步: 观察 OTAE 循环

你应该看到：

```
👁️ 观察 → 正在分析数据结构...
🧠 思考 → AI 正在生成执行计划...
⚡ 执行 → 正在运行 Python 代码...
✅ 评估 → 正在评估结果质量...
```

进度条从 0% 逐步增长到 100%。

### 第五步: 查看结果

- ✅ 结果显示在界面上
- ✅ 质量评分显示（完整性、准确性、一致性）
- ✅ 可下载生成的文件

---

## 📊 测试检查清单

### 基础功能 (必须通过)

- [ ] 应用正常启动
- [ ] 可以上传 Excel 文件
- [ ] 数据正确显示在预览区
- [ ] 可以输入命令
- [ ] 点击执行按钮有响应
- [ ] 进度条正常显示
- [ ] OTAE 图标依次激活
- [ ] 成功生成结果文件

### 多步分析功能

- [ ] 观察阶段正常工作
- [ ] 思考阶段生成计划
- [ ] 执行阶段运行 Python 代码
- [ ] 评估阶段显示质量评分
- [ ] 整个流程耗时合理（10-30秒）

### 错误处理

- [ ] 遇到错误能正确分类
- [ ] 显示错误信息
- [ ] 尝试自动修复
- [ ] 修复失败能降级到快速模式

### 质量评估

- [ ] 显示完整性评分
- [ ] 显示准确性评分
- [ ] 显示一致性评分
- [ ] 提供改进建议

### 双模式切换

- [ ] 智能模式工作正常
- [ ] 可以切换到快速模式
- [ ] 快速模式直接执行
- [ ] 两种模式结果一致

---

## 🔍 关键观察点

### 1. 进度日志

在"执行日志"区域，你应该看到类似的输出：

```
[observing] 正在分析数据结构...
  - 检测到 1 个 Sheet
  - Sheet 名称: 销售数据
  - 行数: 10, 列数: 5

[thinking] AI 正在生成执行计划...
  - 任务: 计算总销售额
  - 方法: sum() 函数

[acting] 正在运行 Python 代码...
  - 执行成功
  - 生成结果文件

[evaluating] 正在评估结果质量...
  - 完整性: 95%
  - 准确性: 90%
  - 一致性: 92%
  - 总体评分: 92.3%
```

### 2. 质量报告

成功完成后，应该显示：

```
质量评估报告
━━━━━━━━━━━━━━━━━━━━━
完整性: 95%  ████████████████████
准确性: 90%  ██████████████████░░
一致性: 92%  ████████████████████
━━━━━━━━━━━━━━━━━━━━━
总体评分: 92.3%  ⭐⭐⭐⭐⭐
```

### 3. OTAE 可视化

界面上的图标应该依次高亮：

```
初始状态:
[👁️ 观察] [🧠 思考] [⚡ 执行] [✅ 评估]
  灰色      灰色      灰色      灰色

执行中:
[👁️ 观察] [🧠 思考] [⚡ 执行] [✅ 评估]
  蓝色      灰色      灰色      灰色

完成后:
[👁️ 观察] [🧠 思考] [⚡ 执行] [✅ 评估]
  绿色      绿色      绿色      绿色
```

---

## 🐛 常见问题

### Q1: 应用启动后显示空白

**解决**:
- 检查 Vite 服务器是否运行（访问 http://localhost:3000）
- 如果没有运行，执行: `npm run dev`

### Q2: 点击执行没有反应

**解决**:
- 打开开发者工具 (F12 或 Ctrl+Shift+I)
- 查看 Console 是否有错误
- 检查 Network 标签，确认 API 调用

### Q3: Python 执行失败

**解决**:
```bash
# 检查 Python 是否可用
python --version

# 检查 pandas 是否安装
python -c "import pandas; print(pandas.__version__)"
```

### Q4: AI 服务无响应

**解决**:
- 检查网络连接
- 确认 API Key 配置正确
- 查看 services/zhipuService.ts

---

## 📝 测试记录

使用这个模板记录测试结果：

```markdown
### 测试日期: _____

**测试文件**: test-simple.xlsx
**测试命令**: 计算总销售额
**执行模式**: 智能模式

**观察结果**:
- 启动时间: ___ 秒
- OTAE 循环: ⬜ 正常 / ❌ 异常
- 进度显示: ⬜ 正常 / ❌ 异常
- 执行时间: ___ 秒
- 质量评分: ___%

**遇到的问题**:


**截图**: (粘贴关键截图)

**总体评价**: ⬜ 通过 / ❌ 失败
```

---

## 🎯 成功标准

### 最小可行 (MVP)
- ✅ 能上传文件并执行简单命令
- ✅ 显示进度和结果
- ✅ 不崩溃

### 功能完整
- ✅ OTAE 循环完整运行
- ✅ 质量评估合理
- ✅ 错误处理有效
- ✅ 双模式切换正常

### 生产就绪
- ✅ 所有测试用例通过
- ✅ 性能满足要求
- ✅ 用户体验流畅

---

## 📞 需要帮助？

如果遇到问题，请：

1. 查看控制台日志 (F12)
2. 记录错误信息
3. 保存截图
4. 查看 `MULTISTEP_TEST_GUIDE.md` 详细指南

---

## 🚀 准备好了吗？

**现在可以开始测试了！**

执行命令:
```bash
npm run electron
```

然后按照上面的步骤进行测试。

**祝测试顺利！** 🎉
