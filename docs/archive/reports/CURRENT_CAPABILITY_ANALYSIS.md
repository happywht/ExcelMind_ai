# ExcelMind AI å½“å‰èƒ½åŠ›åˆ†ææŠ¥å‘Š

## ğŸ“Š æ ¸å¿ƒé—®é¢˜å›ç­”

### âŒ å¤šæ­¥åˆ†æèƒ½åŠ›ï¼š**ä¸å…·å¤‡ï¼ˆä¼ªå¤šæ­¥ï¼‰**

**å½“å‰å®ç°**ï¼š
```
ç”¨æˆ·æŒ‡ä»¤ â†’ AIå•æ¬¡è°ƒç”¨ â†’ ç”Ÿæˆä»£ç  â†’ æ‰§è¡Œ
```

**è¡¨é¢ä¸Šçš„"å¤šæ­¥"**ï¼š
- AI Prompt ä¸­æåˆ°äº† "Observe-Think-Action" æ¦‚å¿µ
- ä»£ç æ³¨é‡Šå†™ç€"æ­£åœ¨å¯åŠ¨æ™ºèƒ½åˆ†æå¾ªç¯"

**å®é™…ä¸Š**ï¼š
- åªæœ‰ä¸€æ¬¡ AI API è°ƒç”¨
- AI åœ¨å•æ¬¡å“åº”ä¸­å®Œæˆæ‰€æœ‰æ€è€ƒ
- æ²¡æœ‰è¿­ä»£ä¼˜åŒ–è¿‡ç¨‹
- æ²¡æœ‰åé¦ˆå¾ªç¯

**è¯æ®**ï¼š
```typescript
// zhipuService.ts:267
export const generateDataProcessingCode = async (
  userPrompt: string,
  filesPreview: FilePreview[]
): Promise<AIProcessResult> {
  // å•æ¬¡ API è°ƒç”¨
  const response = await client.messages.create({
    model: "glm-4.6",
    max_tokens: 4096,
    messages: [{ role: "user", content: systemInstruction }]
  });
  // ç›´æ¥è¿”å›ç»“æœï¼Œæ²¡æœ‰å¾ªç¯
  return result;
}
```

---

### âŒ è‡ªæˆ‘ä¿®å¤èƒ½åŠ›ï¼š**å®Œå…¨ä¸å…·å¤‡**

**é”™è¯¯å¤„ç†æµç¨‹**ï¼š
```
ä»£ç æ‰§è¡Œ â†’ å¤±è´¥ â†’ æŠ›å‡ºé”™è¯¯ â†’ æ˜¾ç¤ºç»™ç”¨æˆ· â†’ ç»“æŸ
```

**ç¼ºå¤±çš„èƒ½åŠ›**ï¼š
1. âŒ æ²¡æœ‰è‡ªåŠ¨é‡è¯•æœºåˆ¶
2. âŒ æ²¡æœ‰é”™è¯¯ä»£ç åˆ†æ
3. âŒ æ²¡æœ‰è®© AI ä¿®å¤è‡ªå·±çš„é”™è¯¯
4. âŒ æ²¡æœ‰ä»å¤±è´¥ä¸­å­¦ä¹ 

**è¯æ®**ï¼š
```typescript
// excelService.ts - executeTransformation
try {
  const result = transformFn(files);  // æ‰§è¡Œä¸€æ¬¡
  if (!isValidResult) {
    throw new Error("Invalid result format");  // ç›´æ¥å¤±è´¥
  }
  resolve(result);
} catch (error) {
  reject(new Error(e.data.error));  // ç›´æ¥æŠ¥é”™ï¼Œæ²¡æœ‰é‡è¯•
}
```

---

## ğŸ”„ çœŸæ­£çš„å¤šæ­¥åˆ†æåº”è¯¥æ˜¯ä»€ä¹ˆæ ·ï¼Ÿ

### ç†æƒ³å®ç°ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¤šæ­¥åˆ†æå¾ªç¯ï¼ˆAgentic Patternï¼‰        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Step 1: Observe                       â”‚
â”‚    â†’ è¯»å–æ•°æ®æ ·æœ¬                      â”‚
â”‚    â†’ è¯†åˆ«åˆ—å’Œå…³ç³»                      â”‚
â”‚                                         â”‚
â”‚  Step 2: Think                         â”‚
â”‚    â†’ åˆ†æéœ€æ±‚                          â”‚
â”‚    â†’ è§„åˆ’ç­–ç•¥                          â”‚
â”‚    â†’ ç”Ÿæˆåˆæ­¥æ–¹æ¡ˆ                      â”‚
â”‚                                         â”‚
â”‚  Step 3: Act (ç¬¬ä¸€æ¬¡å°è¯•)              â”‚
â”‚    â†’ ç”Ÿæˆä»£ç                           â”‚
â”‚    â†’ æ‰§è¡Œä»£ç                           â”‚
â”‚                                         â”‚
â”‚  Step 4: Evaluate                     â”‚
â”‚    â†’ æ£€æŸ¥ç»“æœ                          â”‚
â”‚    â†’ å¦‚æœå¤±è´¥ â†’ å›åˆ° Step 2           â”‚
â”‚    â†’ å¦‚æœæˆåŠŸ â†’ ç»§ç»­                 â”‚
â”‚                                         â”‚
â”‚  Step 5: Optimize (å¯é€‰)              â”‚
â”‚    â†’ ä¼˜åŒ–ç»“æœ                          â”‚
â”‚    â†’ éªŒè¯æ­£ç¡®æ€§                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è‡ªæˆ‘ä¿®å¤å¾ªç¯ï¼š
```
æ‰§è¡Œå¤±è´¥
   â†“
åˆ†æé”™è¯¯åŸå› 
   â†“
è°ƒç”¨ AI ä¿®å¤ä»£ç 
   â†“
é‡æ–°æ‰§è¡Œ
   â†“
æˆåŠŸï¼Ÿâ†’ æ˜¯ï¼šç»“æŸ
       â†’ å¦ï¼šé‡å¤ï¼ˆæœ€å¤š3æ¬¡ï¼‰
```

---

## ğŸ“ˆ å½“å‰æ¨¡å¼ vs çœŸæ­£çš„ Agent èƒ½åŠ›

| èƒ½åŠ› | å½“å‰å®ç° | çœŸæ­£çš„ Agent |
|------|----------|--------------|
| å¤šæ­¥æ¨ç† | âŒ å•æ¬¡è°ƒç”¨ | âœ… è¿­ä»£å¾ªç¯ |
| é”™è¯¯æ£€æµ‹ | âš ï¸ åŸºæœ¬æ•è· | âœ… è¯¦ç»†åˆ†æ |
| è‡ªåŠ¨ä¿®å¤ | âŒ æ—  | âœ… æ™ºèƒ½é‡è¯• |
| å·¥å…·ä½¿ç”¨ | âŒ æ—  | âœ… å¤šå·¥å…·åä½œ |
| è®°å¿†ç®¡ç† | âŒ æ—  | âœ… ä¸Šä¸‹æ–‡è®°å¿† |
| è§„åˆ’èƒ½åŠ› | âš ï¸ é™æ€è§„åˆ’ | âœ… åŠ¨æ€è°ƒæ•´ |
| åæ€èƒ½åŠ› | âŒ æ—  | âœ… ç»“æœéªŒè¯ |

---

## ğŸ¯ è¦å®ç°çœŸæ­£çš„ Agent èƒ½åŠ›éœ€è¦ä»€ä¹ˆï¼Ÿ

### 1. å¤šæ­¥åˆ†ææ¶æ„
```typescript
// éœ€è¦å®ç°
class MultiStepAnalyzer {
  async analyze(userPrompt, data) {
    // Step 1: åˆæ­¥è§‚å¯Ÿ
    const observation = await this.observe(data);

    // Step 2: è§„åˆ’ï¼ˆå¯èƒ½éœ€è¦å¤šè½®ï¼‰
    const plan = await this.plan(userPrompt, observation);

    // Step 3: æ‰§è¡Œå¹¶éªŒè¯
    let result = await this.execute(plan);
    let attempts = 0;

    // Step 4: è¿­ä»£ä¼˜åŒ–
    while (!this.validate(result) && attempts < 3) {
      const feedback = this.analyzeFailure(result);
      plan = await this.refinePlan(plan, feedback);
      result = await this.execute(plan);
      attempts++;
    }

    return result;
  }
}
```

### 2. è‡ªæˆ‘ä¿®å¤æœºåˆ¶
```typescript
// éœ€è¦å®ç°
class SelfRepairingExecutor {
  async executeWithRetry(code, data) {
    let attempt = 0;
    let lastError = null;

    while (attempt < 3) {
      try {
        const result = this.execute(code, data);
        return { success: true, result };
      } catch (error) {
        lastError = error;
        attempt++;

        if (attempt < 3) {
          // è®© AI åˆ†æé”™è¯¯å¹¶ä¿®å¤
          code = await this.askAIToFix(code, error);
        }
      }
    }

    return {
      success: false,
      error: lastError,
      attempts
    };
  }
}
```

### 3. çœŸæ­£çš„æ²™ç®±éš”ç¦»
```typescript
// éœ€è¦å®ç°
class TrueSandbox {
  async executeInSandbox(task) {
    // 1. ä¿å­˜æ•°æ®åˆ°æ²™ç®±æ–‡ä»¶
    const dataFile = await this.writeToSandbox(task.data);

    // 2. åœ¨ç‹¬ç«‹è¿›ç¨‹ä¸­æ‰§è¡Œ
    const result = await this.runInIsolatedProcess(task.command, dataFile);

    // 3. è¯»å–ç»“æœ
    return this.readFromSandbox(result);
  }
}
```

---

## ğŸ’¡ ç»“è®º

### å½“å‰çŠ¶æ€
- âœ… åŸºç¡€ AI åŠŸèƒ½ï¼šå¯ä»¥ç†è§£è‡ªç„¶è¯­è¨€å¹¶ç”Ÿæˆä»£ç 
- âœ… æ•°æ®å¤„ç†ï¼šå¯ä»¥æ‰§è¡Œè½¬æ¢å¹¶è¿”å›ç»“æœ
- âš ï¸ "ä¼ª Agent"ï¼šUI ä¸Šçœ‹èµ·æ¥åƒ Agentï¼Œä½†åº•å±‚ä¸æ˜¯
- âŒ æ— å¤šæ­¥åˆ†æï¼šå•æ¬¡è°ƒç”¨ï¼Œæ— è¿­ä»£
- âŒ æ— è‡ªæˆ‘ä¿®å¤ï¼šå¤±è´¥å³ç»ˆæ­¢ï¼Œæ— é‡è¯•

### ä¸åŸå§‹éœ€æ±‚çš„å·®è·
åŸå§‹éœ€æ±‚æ–‡æ¡£è¦æ±‚çš„æ˜¯ï¼š
- çœŸæ­£çš„æ— å¤´æ²™ç®±ï¼ˆnode-pty éš”ç¦»è¿›ç¨‹ï¼‰
- é¢„ç½®çš„ AI CLIï¼ˆClaude Codeï¼‰
- Agent æ‰§è¡Œèƒ½åŠ›ï¼ˆå¤šæ­¥ã€è‡ªä¿®å¤ï¼‰

å½“å‰å®ç°æä¾›çš„æ˜¯ï¼š
- Web Worker æ‰§è¡Œï¼ˆéçœŸæ­£éš”ç¦»ï¼‰
- æ™ºè°± AI API è°ƒç”¨ï¼ˆéé¢„ç½® CLIï¼‰
- å•æ­¥æ‰§è¡Œï¼ˆé Agentï¼‰

---

## ğŸš€ æ”¹è¿›å»ºè®®

### çŸ­æœŸï¼ˆç®€å•ï¼‰
1. æ·»åŠ é”™è¯¯é‡è¯•æœºåˆ¶
2. æ”¹è¿›é”™è¯¯æç¤ºï¼Œè®©ç”¨æˆ·çŸ¥é“å“ªé‡Œå‡ºé”™
3. ä¼˜åŒ– AI Promptï¼Œæé«˜é¦–æ¬¡æˆåŠŸç‡

### ä¸­æœŸï¼ˆä¸­ç­‰ï¼‰
1. å®ç°åŸºæœ¬çš„é”™è¯¯ä¿®å¤å¾ªç¯
2. æ·»åŠ æ‰§è¡Œç»“æœçš„éªŒè¯æ­¥éª¤
3. å®ç°"ä¸¤æ­¥æ‰§è¡Œ"ï¼šè§„åˆ’ â†’ æ‰§è¡Œ

### é•¿æœŸï¼ˆå¤æ‚ï¼‰
1. å®ç°çœŸæ­£çš„å¤šæ­¥ Agent æ¶æ„
2. å®ç°å®Œæ•´çš„è‡ªæˆ‘ä¿®å¤èƒ½åŠ›
3. é›†æˆçœŸæ­£çš„æ²™ç®±éš”ç¦»ï¼ˆnode-pty + Claude Code CLIï¼‰

---

**æ€»ç»“**ï¼šå½“å‰æ¨¡å¼æ˜¯ä¸€ä¸ª"èªæ˜çš„è‡ªåŠ¨åŒ–è„šæœ¬"ï¼Œä½†ä¸æ˜¯çœŸæ­£çš„"AI Agent"ã€‚å®ƒèƒ½å®ŒæˆåŸºæœ¬çš„ä»»åŠ¡ï¼Œä½†ç¼ºä¹é«˜çº§çš„æ¨ç†å’Œè‡ªæˆ‘ä¿®å¤èƒ½åŠ›ã€‚
