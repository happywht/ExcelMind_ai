# E2E æµ‹è¯•å¿«é€Ÿæ‰§è¡ŒæŒ‡å—

**ç›®æ ‡**: åœ¨ 30 åˆ†é’Ÿå†…å®Œæˆ ExcelMind AI çš„æ ¸å¿ƒ E2E æµ‹è¯•

---

## å‰ç½®å‡†å¤‡ï¼ˆ5 åˆ†é’Ÿï¼‰

### æ­¥éª¤ 1: æ£€æŸ¥ç¯å¢ƒ

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd D:\å®¶åº­\é’èªèµ‹èƒ½\excelmind-ai

# æ£€æŸ¥ Node.js ç‰ˆæœ¬
node -e "console.log('Node:', process.version)"
# åº”æ˜¾ç¤º: Node: v22.18.0

# æ£€æŸ¥ä¾èµ–å®‰è£…
dir node_modules
# å¦‚æœä¸å­˜åœ¨ï¼Œè¿è¡Œ: pnpm install
```

### æ­¥éª¤ 2: å¯åŠ¨åº”ç”¨

**é€‰é¡¹ A: Vite å¼€å‘æœåŠ¡å™¨ï¼ˆæ¨èç”¨äºæµ‹è¯•ï¼‰**
```bash
# åœ¨ç»ˆç«¯ 1 è¿è¡Œ
npm run dev

# ç­‰å¾…æ˜¾ç¤º:
# VITE v6.2.0  ready in xxx ms
# âœ  Local:   http://localhost:3000/
```

**é€‰é¡¹ B: Electron åº”ç”¨ï¼ˆçœŸå®ç¯å¢ƒï¼‰**
```bash
# åœ¨ç»ˆç«¯ 1 è¿è¡Œ
npm run electron-dev

# ç­‰å¾… Electron çª—å£æ‰“å¼€
```

### æ­¥éª¤ 3: éªŒè¯æœåŠ¡è¿è¡Œ

```bash
# åœ¨æ–°ç»ˆç«¯è¿è¡Œ
powershell -Command "Invoke-WebRequest -Uri http://localhost:3000 -TimeoutSec 5"

# åº”æ˜¾ç¤º: StatusCode 200
```

---

## å¿«é€Ÿæµ‹è¯•ï¼ˆ10 åˆ†é’Ÿï¼‰

### æµ‹è¯• 1: UI å¿«é€ŸéªŒè¯ï¼ˆ2 åˆ†é’Ÿï¼‰

```bash
# åœ¨ç»ˆç«¯ 2 è¿è¡Œ
npx playwright test tests/e2e/quick-test.spec.ts --headed

# æµ‹è¯•å†…å®¹:
# âœ… åº”ç”¨è¿æ¥
# âœ… UI å…ƒç´ æ˜¾ç¤º
# âœ… æ–‡ä»¶ä¸Šä¼ åŒºåŸŸ
# âœ… æˆªå›¾ä¿å­˜
```

**é¢„æœŸç»“æœ**:
- æµ‹è¯•é€šè¿‡ âœ…
- æˆªå›¾ä¿å­˜åœ¨ `tests/screenshots/`

### æµ‹è¯• 2: åŸºç¡€åŠŸèƒ½éªŒè¯ï¼ˆ3 åˆ†é’Ÿï¼‰

```bash
# è¿è¡ŒåŸºç¡€åŠŸèƒ½æµ‹è¯•
node scripts/run-agentic-tests.cjs basic

# æµ‹è¯•å†…å®¹:
# âœ… æ™ºèƒ½å¤„ç†ç•Œé¢å¯¼èˆª
# âœ… æ–‡ä»¶ä¸Šä¼ å’Œé¢„è§ˆ
# âœ… å‘½ä»¤è¾“å…¥
# âœ… æ‰§è¡ŒæŒ‰é’®å“åº”
```

**é¢„æœŸç»“æœ**:
- æ‰€æœ‰æµ‹è¯•é€šè¿‡ âœ…
- æˆªå›¾æ˜¾ç¤ºå®Œæ•´ UI

### æµ‹è¯• 3: OTAE å¾ªç¯æµ‹è¯•ï¼ˆ5 åˆ†é’Ÿï¼‰

```bash
# è¿è¡Œ OTAE å¾ªç¯æµ‹è¯•
node scripts/run-agentic-tests.cjs otae

# æµ‹è¯•å†…å®¹:
# âœ… è§‚å¯Ÿé˜¶æ®µï¼ˆObserveï¼‰
# âœ… æ€è€ƒé˜¶æ®µï¼ˆThinkï¼‰
# âœ… æ‰§è¡Œé˜¶æ®µï¼ˆActï¼‰
# âœ… è¯„ä¼°é˜¶æ®µï¼ˆEvaluateï¼‰
```

**é¢„æœŸç»“æœ**:
- 4 ä¸ªé˜¶æ®µå…¨éƒ¨å®Œæˆ âœ…
- è´¨é‡è¯„åˆ†æ˜¾ç¤º âœ…
- æ‰§è¡Œæ—¶é—´ < 30 ç§’

---

## å®Œæ•´æµ‹è¯•ï¼ˆ15 åˆ†é’Ÿï¼‰

### æµ‹è¯• 4: é”™è¯¯ä¿®å¤æœºåˆ¶ï¼ˆ3 åˆ†é’Ÿï¼‰

```bash
node scripts/run-agentic-tests.cjs error-repair

# è§‚å¯Ÿé‡ç‚¹:
# - é”™è¯¯æ£€æµ‹è§¦å‘
# - ä¿®å¤æç¤ºæ˜¾ç¤º
# - è‡ªåŠ¨é‡è¯•æˆåŠŸ
```

### æµ‹è¯• 5: æ¨¡å¼å¯¹æ¯”ï¼ˆ3 åˆ†é’Ÿï¼‰

```bash
node scripts/run-agentic-tests.cjs mode-compare

# è§‚å¯Ÿé‡ç‚¹:
# - æ™ºèƒ½æ¨¡å¼æ‰§è¡Œæ—¶é—´
# - å¿«é€Ÿæ¨¡å¼æ‰§è¡Œæ—¶é—´
# - æ€§èƒ½å·®å¼‚ > 30%
```

### æµ‹è¯• 6: è´¨é‡è¯„ä¼°ï¼ˆ3 åˆ†é’Ÿï¼‰

```bash
node scripts/run-agentic-tests.cjs quality

# è§‚å¯Ÿé‡ç‚¹:
# - å®Œæ•´æ€§è¯„åˆ†
# - å‡†ç¡®æ€§è¯„åˆ†
# - ä¸€è‡´æ€§è¯„åˆ†
```

### æµ‹è¯• 7: å¤šæ­¥éª¤ä»»åŠ¡ï¼ˆ4 åˆ†é’Ÿï¼‰

```bash
node scripts/run-agentic-tests.cjs multistep

# è§‚å¯Ÿé‡ç‚¹:
# - å¤æ‚å‘½ä»¤è§£æ
# - å¤šä¸ª OTAE å¾ªç¯
# - æœ€ç»ˆç»“æœæ­£ç¡®
```

### æµ‹è¯• 8: ç”ŸæˆæŠ¥å‘Šï¼ˆ2 åˆ†é’Ÿï¼‰

```bash
node scripts/run-agentic-tests.cjs report

# ç”Ÿæˆæ–‡ä»¶:
# - comprehensive-test-report.txt
# - mode-comparison-report.txt
# - quality-assessment-report.txt
```

---

## æŸ¥çœ‹ç»“æœï¼ˆ5 åˆ†é’Ÿï¼‰

### HTML æŠ¥å‘Šï¼ˆæ¨èï¼‰

```bash
# æ‰“å¼€ HTML æŠ¥å‘Š
npx playwright show-report tests/test-results/html

# æˆ–åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€:
# file:///D:/å®¶åº­/é’èªèµ‹èƒ½/excelmind-ai/tests/test-results/html/index.html
```

**HTML æŠ¥å‘ŠåŒ…å«**:
- ğŸ“Š æµ‹è¯•é€šè¿‡ç‡
- ğŸ“¸ å¤±è´¥æˆªå›¾
- ğŸ¬ æ‰§è¡Œè§†é¢‘
- ğŸ“ è¯¦ç»†æ—¥å¿—

### æ–‡æœ¬æŠ¥å‘Š

```bash
# æŸ¥çœ‹ç»¼åˆæŠ¥å‘Š
type tests\screenshots\agentic-otae\comprehensive-test-report.txt

# æŸ¥çœ‹æ¨¡å¼å¯¹æ¯”
type tests\screenshots\agentic-otae\mode-comparison-report.txt

# æŸ¥çœ‹è´¨é‡è¯„ä¼°
type tests\screenshots\agentic-otae\quality-assessment-report.txt
```

### æˆªå›¾æŸ¥çœ‹

```bash
# æ‰“å¼€æˆªå›¾ç›®å½•
explorer tests\screenshots\agentic-otae

# å…³é”®æˆªå›¾:
# - 01-homepage.png - ä¸»é¡µ
# - 02-smart-ops-interface.png - æ™ºèƒ½å¤„ç†ç•Œé¢
# - 03-file-uploaded.png - æ–‡ä»¶ä¸Šä¼ å
# - 07-otae-phase-*.png - OTAE å„é˜¶æ®µ
# - 08-otae-final.png - æœ€ç»ˆç»“æœ
```

---

## æ•…éšœæ’é™¤

### é—®é¢˜ 1: æœåŠ¡å™¨æœªè¿è¡Œ

**é”™è¯¯ä¿¡æ¯**: `Server not running`

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
netstat -ano | findstr :3000

# å¦‚æœè¢«å ç”¨ï¼Œæ€æ‰è¿›ç¨‹
taskkill /PID <è¿›ç¨‹ID> /F

# é‡æ–°å¯åŠ¨
npm run dev
```

### é—®é¢˜ 2: æµ‹è¯•è¶…æ—¶

**é”™è¯¯ä¿¡æ¯**: `Test timeout of 120000ms exceeded`

**è§£å†³æ–¹æ¡ˆ**:
```bash
# å¢åŠ è¶…æ—¶æ—¶é—´
# åœ¨ playwright.config.ts ä¸­ä¿®æ”¹:
actionTimeout: 120000,  # æ”¹ä¸º 120 ç§’
navigationTimeout: 120000
```

### é—®é¢˜ 3: AI æœåŠ¡æ— å“åº”

**é”™è¯¯ä¿¡æ¯**: `AI service error` æˆ– `timeout`

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥ API Key é…ç½®
# æŸ¥çœ‹ .env æ–‡ä»¶æˆ–ç¯å¢ƒå˜é‡
echo %ZHIPU_API_KEY%

# æ£€æŸ¥ç½‘ç»œè¿æ¥
ping open.bigmodel.cn

# å¦‚æœç½‘ç»œé—®é¢˜ï¼Œä½¿ç”¨ Mock æµ‹è¯•
npm run test:e2e:mock
```

### é—®é¢˜ 4: æµ‹è¯•æ–‡ä»¶ä¸å­˜åœ¨

**é”™è¯¯ä¿¡æ¯**: `Test file not found`

**è§£å†³æ–¹æ¡ˆ**:
```bash
# é‡æ–°ç”Ÿæˆæµ‹è¯•æ–‡ä»¶
npm run test:generate-files

# éªŒè¯æ–‡ä»¶å­˜åœ¨
dir public\test-files\test-*.xlsx
```

### é—®é¢˜ 5: Playwright æµè§ˆå™¨æœªå®‰è£…

**é”™è¯¯ä¿¡æ¯**: `Executable doesn't exist`

**è§£å†³æ–¹æ¡ˆ**:
```bash
# å®‰è£… Playwright æµè§ˆå™¨
npx playwright install chromium

# éªŒè¯å®‰è£…
npx playwright --version
```

---

## æ€§èƒ½åŸºå‡†

### é¢„æœŸæ‰§è¡Œæ—¶é—´

| æµ‹è¯•ç±»å‹ | é¢„æœŸæ—¶é—´ | å¯æ¥å—èŒƒå›´ |
|----------|----------|------------|
| å¿«é€Ÿæµ‹è¯• | 30 ç§’ | 20-60 ç§’ |
| åŸºç¡€åŠŸèƒ½ | 1 åˆ†é’Ÿ | 30-90 ç§’ |
| OTAE å¾ªç¯ | 2 åˆ†é’Ÿ | 1-3 åˆ†é’Ÿ |
| é”™è¯¯ä¿®å¤ | 2 åˆ†é’Ÿ | 1-3 åˆ†é’Ÿ |
| æ¨¡å¼å¯¹æ¯” | 4 åˆ†é’Ÿ | 2-6 åˆ†é’Ÿ |
| è´¨é‡è¯„ä¼° | 2 åˆ†é’Ÿ | 1-3 åˆ†é’Ÿ |
| å¤šæ­¥éª¤ | 3 åˆ†é’Ÿ | 2-5 åˆ†é’Ÿ |
| **æ€»è®¡** | **15 åˆ†é’Ÿ** | **10-25 åˆ†é’Ÿ** |

### æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | ç›®æ ‡å€¼ | è­¦å‘Šé˜ˆå€¼ |
|------|--------|----------|
| ç®€å•ä»»åŠ¡ | < 10 ç§’ | > 15 ç§’ |
| å¤æ‚ä»»åŠ¡ | < 30 ç§’ | > 45 ç§’ |
| å†…å­˜ä½¿ç”¨ | < 500MB | > 700MB |
| CPU ä½¿ç”¨ | < 50% | > 70% |

---

## æµ‹è¯•æ¸…å•

### å¿«é€ŸéªŒè¯ï¼ˆ5 åˆ†é’Ÿï¼‰
- [ ] åº”ç”¨å¯åŠ¨æˆåŠŸ
- [ ] æœåŠ¡å™¨è¿è¡Œæ­£å¸¸ï¼ˆhttp://localhost:3000ï¼‰
- [ ] å¿«é€Ÿæµ‹è¯•é€šè¿‡
- [ ] æˆªå›¾æ­£å¸¸ä¿å­˜

### åŸºç¡€åŠŸèƒ½ï¼ˆ10 åˆ†é’Ÿï¼‰
- [ ] UI å…ƒç´ æ˜¾ç¤ºæ­£ç¡®
- [ ] æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½æ­£å¸¸
- [ ] å‘½ä»¤è¾“å…¥å¯ç”¨
- [ ] æ‰§è¡ŒæŒ‰é’®å“åº”

### OTAE å¾ªç¯ï¼ˆ10 åˆ†é’Ÿï¼‰
- [ ] è§‚å¯Ÿé˜¶æ®µå®Œæˆ
- [ ] æ€è€ƒé˜¶æ®µå®Œæˆ
- [ ] æ‰§è¡Œé˜¶æ®µå®Œæˆ
- [ ] è¯„ä¼°é˜¶æ®µå®Œæˆ
- [ ] è´¨é‡è¯„åˆ†æ˜¾ç¤º

### é«˜çº§åŠŸèƒ½ï¼ˆ5 åˆ†é’Ÿï¼‰
- [ ] é”™è¯¯ä¿®å¤è§¦å‘
- [ ] æ¨¡å¼å¯¹æ¯”å®Œæˆ
- [ ] è´¨é‡è¯„ä¼°æ­£å¸¸
- [ ] å¤šæ­¥éª¤ä»»åŠ¡å®Œæˆ

---

## ä¸‹ä¸€æ­¥

### å¦‚æœæ‰€æœ‰æµ‹è¯•é€šè¿‡ âœ…

1. **æŸ¥çœ‹æµ‹è¯•æŠ¥å‘Š**
   ```bash
   npx playwright show-report tests/test-results/html
   ```

2. **è®°å½•æµ‹è¯•ç»“æœ**
   - ä¿å­˜æµ‹è¯•æŠ¥å‘Š
   - è®°å½•æ€§èƒ½æŒ‡æ ‡
   - å½’æ¡£æˆªå›¾

3. **å‡†å¤‡å‘å¸ƒ**
   - æ£€æŸ¥è´¨é‡é—¨ç¦
   - ç”Ÿæˆå‘å¸ƒè¯´æ˜
   - æ‰§è¡Œé¢„å‘å¸ƒæ£€æŸ¥

### å¦‚æœæœ‰æµ‹è¯•å¤±è´¥ âŒ

1. **æŸ¥çœ‹å¤±è´¥åŸå› **
   ```bash
   # æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
   type tests\test-results\results.xml
   ```

2. **åˆ†æå¤±è´¥æˆªå›¾**
   ```bash
   # æ‰“å¼€æˆªå›¾ç›®å½•
   explorer tests\screenshots\agentic-otae
   ```

3. **ä¿®å¤é—®é¢˜**
   - å®šä½ä»£ç é—®é¢˜
   - ä¿®å¤ Bug
   - é‡æ–°æµ‹è¯•

4. **éªŒè¯ä¿®å¤**
   ```bash
   # é‡æ–°è¿è¡Œå¤±è´¥çš„æµ‹è¯•
   npx playwright test tests/e2e/<å¤±è´¥çš„æµ‹è¯•æ–‡ä»¶> --headed
   ```

---

## è”ç³»æ”¯æŒ

å¦‚æœé‡åˆ°æ— æ³•è§£å†³çš„é—®é¢˜:

1. **æŸ¥çœ‹å®Œæ•´æµ‹è¯•æŠ¥å‘Š**
   ```bash
   type E2E_TEST_REPORT.md
   ```

2. **æŸ¥çœ‹ç³»ç»Ÿæ¶æ„æ–‡æ¡£**
   ```bash
   type ARCHITECTURE.md
   ```

3. **æŸ¥çœ‹æµ‹è¯•æŒ‡å—**
   ```bash
   type MULTISTEP_TEST_GUIDE.md
   ```

---

**ç¥ä½ æµ‹è¯•é¡ºåˆ©ï¼** ğŸš€

**é¢„è®¡æ€»è€—æ—¶**: 30 åˆ†é’Ÿ
**æµ‹è¯•è¦†ç›–ç‡**: 80%+
**é€šè¿‡æ ‡å‡†**: æ‰€æœ‰æ ¸å¿ƒæµ‹è¯•é€šè¿‡
