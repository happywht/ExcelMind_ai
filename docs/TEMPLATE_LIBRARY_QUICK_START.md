# 模板库功能快速启动指南

## 概述

模板库功能已完整实施并集成到文档空间。本指南帮助您快速上手使用。

## 功能亮点

- 📚 **本地模板管理**：保存和管理常用Word模板
- 🔍 **智能搜索**：快速找到需要的模板
- 🏷️ **分类标签**：灵活的组织方式
- ⚡ **一键使用**：从模板库直接开始文档生成
- 📊 **使用统计**：追踪模板使用情况

## 快速开始

### 1. 访问模板库

在文档空间页面，点击顶部导航栏的"**模板库**"Tab。

```
┌─────────────────────────────────────────────┐
│ 上传 | 模板库 | 模板预览 | 数据预览 | ...  │
└─────────────────────────────────────────────┘
         ↑
    点击这里
```

### 2. 上传您的第一个模板

#### 步骤：
1. 点击右上角的"**上传模板**"按钮
2. 拖拽或选择一个.docx文件
3. 填写模板信息：
   - **名称**：例如"劳动合同模板"
   - **分类**：选择"合同类"
   - **标签**：例如"人事, 常用, 正式员工"
   - **描述**：例如"标准劳动合同模板，包含基本条款"
4. 点击"**上传到库**"

#### 上传后的效果：
- 模板保存在浏览器本地（IndexedDB）
- 自动提取文档中的占位符（如`{{员工姓名}}`）
- 可随时重复使用

### 3. 使用模板生成文档

#### 步骤：
1. 在模板库中找到需要的模板
2. 将鼠标悬停在模板卡片上
3. 点击"**使用模板**"按钮
4. 系统自动：
   - 加载模板文件
   - 跳转到"上传"Tab
   - 显示模板预览
5. 继续上传Excel数据
6. 输入AI指令生成映射
7. 批量生成文档

#### 工作流图：
```
模板库 → 选择模板 → 上传Tab → 数据上传 → AI映射 → 生成文档
   ↓                        ↓
加载模板                  模板预览
```

### 4. 管理模板

#### 收藏模板
- 点击卡片右上角的⭐图标
- 收藏的模板会显示实心星星
- 使用"只看收藏"筛选快速找到

#### 编辑元数据
- 悬停在卡片上，点击✏️编辑图标
- 修改名称、分类、标签、描述
- 保存更改

#### 删除模板
- 悬停在卡片上，点击🗑️删除图标
- 确认删除
- 模板将从本地存储中移除

### 5. 搜索和筛选

#### 搜索
在搜索框中输入关键词，支持：
- 模板名称
- 描述内容
- 标签
- 占位符（如`{{姓名}}`）

#### 筛选
- **按分类**：点击分类按钮（合同类、证书类等）
- **按收藏**：点击"只看收藏"
- **组合筛选**：可同时使用多个筛选条件

#### 排序
- **创建时间**：最新上传的优先
- **最近使用**：最近使用的优先
- **使用次数**：最常用的优先
- **名称**：按字母顺序
- **文件大小**：文件大小排序

#### 视图切换
- **网格视图**：卡片网格布局（默认）
- **列表视图**：紧凑列表布局

## 常见问题

### Q: 模板保存在哪里？
A: 模板保存在浏览器的IndexedDB中，完全本地存储，不会上传到服务器。

### Q: 存储空间有限制吗？
A: 有。浏览器通常限制IndexedDB为50MB左右，足够存储数百个Word模板。

### Q: 可以导出模板库吗？
A: 当前版本不支持导出。未来版本会添加备份和恢复功能。

### Q: 模板支持哪些格式？
A: 目前只支持.docx格式（Microsoft Word 2007+）。

### Q: 占位符是如何识别的？
A: 系统自动识别双花括号格式：`{{字段名}}`。建议在模板中使用此格式。

### Q: 可以在手机上使用吗？
A: 可以，但最佳体验建议使用桌面浏览器。

## 技巧和最佳实践

### 1. 模板命名规范
- 使用清晰、描述性的名称
- 包含版本号（如"劳动合同 v1.0"）
- 标注用途（如"劳动合同 - 技术岗位"）

### 2. 标签策略
- 使用分类标签（如"人事"、"销售"）
- 使用状态标签（如"草稿"、"正式"、"已归档"）
- 使用频率标签（如"常用"、"偶尔使用"）

### 3. 描述填写
- 简要说明模板用途
- 列出主要占位符
- 说明适用场景
- 添加使用说明

### 4. 定期整理
- 删除不再使用的模板
- 更新过时的描述
- 归档旧版本模板

## 界面指南

### 模板卡片说明
```
┌─────────────────────────────────────┐
│ ⭐                           🗑️ ✏️ │ ← 操作按钮（悬停显示）
│                                     │
│         [模板缩略图]               │
│      [悬停显示"使用模板"按钮]        │
│                                     │
│ 劳动合同模板           [合同] [v1.0]│
│                                     │
│ 标准劳动合同模板，包含基本条款       │
│                                     │
│ [人事] [常用] [正式员工]             │ ← 标签
│                                     │
│ 📊3  ⬇️5  📄25KB  🕐2天前          │ ← 统计信息
└─────────────────────────────────────┘
```

### 统计信息说明
- **📊 数字**：占位符数量
- **⬇️ 数字**：使用次数
- **📄 大小**：文件大小
- **🕐 时间**：创建时间（今天/昨天/X天前）

## 错误处理

### 上传失败
**问题**：显示"上传失败"错误
**解决方案**：
1. 检查文件是否为.docx格式
2. 确认文件大小不超过10MB
3. 刷新页面重试
4. 检查浏览器存储空间

### 加载失败
**问题**：模板无法加载
**解决方案**：
1. 刷新页面
2. 清除浏览器缓存
3. 检查IndexedDB是否可用

### 搜索无结果
**问题**：搜索不到模板
**解决方案**：
1. 确认关键词拼写正确
2. 尝试使用更通用的关键词
3. 清除筛选条件

## 键盘快捷键

暂不支持键盘快捷键。未来版本会添加：
- `Ctrl/Cmd + K`：快速搜索
- `Ctrl/Cmd + U`：上传模板
- `Ctrl/Cmd + N`：新建模板

## 未来功能

### 即将推出
- [ ] 批量操作（批量删除、导出）
- [ ] 模板分组（文件夹）
- [ ] 模板版本控制
- [ ] 导入/导出模板库
- [ ] 云同步（可选）

### 考虑中
- [ ] 模板分享
- [ ] AI推荐
- [ ] 模板市场
- [ ] 协作编辑

## 获取帮助

### 文档
- 完整文档：`docs/TEMPLATE_LIBRARY_IMPLEMENTATION_SUMMARY.md`
- API文档：代码中的JSDoc注释

### 支持
- 提交Issue：GitHub Issues
- 讨论区：GitHub Discussions

## 更新日志

### v1.0.0 (2026-01-28)
- ✅ 初始版本发布
- ✅ 基础CRUD功能
- ✅ 搜索、筛选、排序
- ✅ 收藏功能
- ✅ 使用统计
- ✅ 完整测试覆盖

---

**祝您使用愉快！** 🎉
