# ExcelMind AI - 用户测试指南

**应用已重启完成！** 现在您可以亲自测试多步分析系统。

---

## ✅ 应用状态

| 服务 | 状态 | 端口 |
|------|------|------|
| **Vite 开发服务器** | ✅ 运行中 | 3000 |
| **Electron 应用** | ✅ 运行中 | - |

**应用窗口应该已经打开。如果没有看到，请检查任务栏。**

---

## 🚀 快速开始（5分钟）

### 第一步：找到应用窗口

1. 查看任务栏或桌面
2. 找到 **ExcelMind AI** 或 **Electron** 窗口
3. 点击打开应用

### 第二步：上传测试文件

1. 点击 **"智能处理"** 按钮（或类似名称）
2. 点击 **"添加文件"** 或 **"上传文件"** 按钮
3. 导航到: `public/test-files/`
4. 选择: **test-simple.xlsx**

### 第三步：输入命令

在命令输入框输入：
```
计算总销售额
```

### 第四步：执行分析

1. **确保"智能模式"已勾选**（通常默认勾选）
2. 点击 **"执行转换"** 或 **"执行智能处理"** 按钮

### 第五步：观察多步分析

您应该看到：

```
进度条: 0% → 100%

OTAE 循环:
👁️ 观察 → 分析数据结构...
🧠 思考 → AI 生成执行计划...
⚡ 执行 → 运行 Python 代码...
✅ 评估 → 质量评分...

质量报告:
完整性: XX%
准确性: XX%
一致性: XX%
总体评分: XX%
```

---

## 📊 测试场景推荐

### 场景 1: 基础功能（推荐先测试）

**文件**: `test-simple.xlsx`
**命令**: `计算总销售额`
**预期时间**: 10-30秒
**验证点**:
- ✅ 进度条显示
- ✅ OTAE 四个阶段依次显示
- ✅ 质量评分显示
- ✅ 生成结果文件

---

### 场景 2: 错误修复

**文件**: `test-complex.xlsx`
**命令**: `计算每个部门的平均工资`
**特点**: 包含空值，会触发错误检测
**预期时间**: 20-40秒
**验证点**:
- ✅ 检测到空值错误
- ✅ 尝试自动修复
- ✅ 显示修复过程

---

### 场景 3: 质量评估

**文件**: `test-edge.xlsx`
**命令**: `过滤无效数据并计算库存总值`
**特点**: 包含负值、零值、无效分类
**预期时间**: 20-40秒
**验证点**:
- ✅ 三维度质量评分
- ✅ 改进建议

---

### 场景 4: 模式对比

**步骤**:
1. 先用**智能模式**执行一个任务
2. 记录执行时间
3. 切换到**快速模式**（取消勾选"智能模式"）
4. 执行相同任务
5. 对比执行时间

**预期结果**:
- 智能模式: 15-30秒（包含分析和评估）
- 快速模式: 5-15秒（直接执行）

---

## 🎯 关键观察点

### 1. OTAE 循环完整性

您应该看到以下四个阶段依次显示：

| 阶段 | 图标 | 说明 |
|------|------|------|
| **观察** | 👁️ | 分析数据结构、列名、数据类型 |
| **思考** | 🧠 | AI 生成执行计划、选择处理方法 |
| **执行** | ⚡ | 运行 Python 代码、处理数据 |
| **评估** | ✅ | 评估结果质量、计算评分 |

### 2. 进度监控

- ✅ 进度条从 0% 增长到 100%
- ✅ 实时显示当前阶段
- ✅ 日志实时更新

### 3. 质量报告

完成时应显示：
- **完整性评分**: 数据是否完整
- **准确性评分**: 结果是否准确
- **一致性评分**: 逻辑是否一致
- **总体评分**: 综合评价

### 4. 错误处理

如果遇到错误：
- ✅ 显示错误类型
- ✅ 尝试自动修复
- ✅ 显示修复进度
- ✅ 失败时自动降级到快速模式

---

## 📁 测试文件清单

所有测试文件位于: `public/test-files/`

| 文件名 | 大小 | 用途 | 推荐命令 |
|--------|------|------|----------|
| **test-simple.xlsx** | 5.8 KB | 基础功能 | "计算总销售额" |
| **test-complex.xlsx** | 6.7 KB | 错误修复 | "计算平均工资" |
| **test-edge.xlsx** | 5.8 KB | 质量评估 | "过滤无效数据" |
| **test-audit.xlsx** | 7.9 KB | 实际场景 | "检查借贷平衡" |
| **test-aggregation.xlsx** | 7.3 KB | 多Sheet关联 | "统计客户订单" |

---

## 💡 测试技巧

### 快速验证（2分钟）

1. 上传 `test-simple.xlsx`
2. 输入: `计算总销售额`
3. 点击执行
4. 观察进度条和OTAE循环

### 完整测试（10分钟）

依次测试5个文件，每个文件测试1-2个命令

### 对比测试（5分钟）

1. 智能模式执行任务
2. 切换到快速模式
3. 执行相同任务
4. 对比时间

---

## 🐛 如果遇到问题

### 问题1: 应用窗口没打开

**解决**:
```bash
# 检查进程
tasklist | findstr node

# 重启应用
npm run electron
```

### 问题2: 点击执行没反应

**检查**:
- 确认已上传文件
- 确认已输入命令
- 查看控制台日志（F12）

### 问题3: 执行时间过长

**正常范围**:
- 简单任务: 10-30秒
- 复杂任务: 30-60秒
- 多Sheet任务: 40-90秒

**超过2分钟**: 可能有问题，检查控制台

### 问题4: 质量评分显示0或NaN

**可能原因**:
- AI 服务响应慢
- 返回格式问题
- 数据格式异常

**解决**: 等待或重新执行

---

## 📝 测试记录模板

```markdown
## 测试记录

**测试时间**: __
**测试文件**: __
**测试命令**: __
**执行模式**: 智能模式 / 快速模式

### 执行过程
- 启动时间: __ 秒
- 执行时间: __ 秒
- 总耗时: __ 秒

### OTAE 循环
- [ ] 观察阶段: __ 秒
- [ ] 思考阶段: __ 秒
- [ ] 执行阶段: __ 秒
- [ ] 评估阶段: __ 秒

### 质量评分
- 完整性: __%
- 准确性: __%
- 一致性: __%
- 总体: __%

### 遇到的问题:


### 总体评价
⬜ 优秀 | ⬜ 良好 | ⬜ 一般 | ⬜ 需要改进
```

---

## 🎉 成功标准

### 最小可行（MVP）
- ✅ 能上传文件
- ✅ 能输入命令
- ✅ 能执行分析
- ✅ 能显示结果

### 功能完整
- ✅ OTAE 循环完整显示
- ✅ 质量评分合理
- ✅ 错误能检测和修复
- ✅ 双模式都能工作

### 用户体验
- ✅ 界面友好
- ✅ 进度清晰
- ✅ 响应及时
- ✅ 错误提示清楚

---

## 🚀 准备好了！

**应用已启动，测试文件已就绪，现在开始测试吧！** 🎊

**记住**:
- 先用简单文件测试
- 观察完整的OTAE循环
- 记录执行时间
- 尝试不同模式

---

**需要帮助？** 查看控制台日志（F12）或查看详细文档。

**祝测试顺利！** ✨
